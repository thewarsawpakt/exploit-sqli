// Decompiled with JetBrains decompiler
// Type: UrlListView
// Assembly: SQLi Dumper, Version=8.5.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FFDD07D3-5737-4188-BACA-DE2D004C7CCF
// Assembly location: C:\Users\cole\Desktop\SQLi Dumper v8.5 [VeryClean]\SQLi v.8.5 VeryClean by Stephanny.exe

using DataBase;
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Runtime.CompilerServices;
using System.Threading;
using System.Timers;
using System.Windows.Forms;

public class UrlListView : ListViewExt, IEnumerable
{
  [AccessedThroughProperty("imgCoutryFlags")]
  private ImageList _imgCoutryFlags;
  private IContainer components;
  private UrlListView.VulDB __VulDB;

  internal virtual ImageList imgCoutryFlags
  {
    get => this._imgCoutryFlags;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._imgCoutryFlags = value;
  }

  private void InitializeComponent()
  {
    this.components = (IContainer) new System.ComponentModel.Container();
    ComponentResourceManager componentResourceManager = new ComponentResourceManager(typeof (UrlListView));
    this.imgCoutryFlags = new ImageList(this.components);
    this.SuspendLayout();
    this.imgCoutryFlags.ImageStream = (ImageListStreamer) componentResourceManager.GetObject("imgCoutryFlags.ImageStream");
    this.imgCoutryFlags.TransparentColor = Color.Transparent;
    this.imgCoutryFlags.Images.SetKeyName(0, "ad.png");
    this.imgCoutryFlags.Images.SetKeyName(1, "ad.woa.png");
    this.imgCoutryFlags.Images.SetKeyName(2, "ae.png");
    this.imgCoutryFlags.Images.SetKeyName(3, "af.png");
    this.imgCoutryFlags.Images.SetKeyName(4, "ag.png");
    this.imgCoutryFlags.Images.SetKeyName(5, "ai.png");
    this.imgCoutryFlags.Images.SetKeyName(6, "al.png");
    this.imgCoutryFlags.Images.SetKeyName(7, "am.png");
    this.imgCoutryFlags.Images.SetKeyName(8, "an.png");
    this.imgCoutryFlags.Images.SetKeyName(9, "ao.png");
    this.imgCoutryFlags.Images.SetKeyName(10, "aq.png");
    this.imgCoutryFlags.Images.SetKeyName(11, "ar.png");
    this.imgCoutryFlags.Images.SetKeyName(12, "ar.woa.png");
    this.imgCoutryFlags.Images.SetKeyName(13, "as.png");
    this.imgCoutryFlags.Images.SetKeyName(14, "at.png");
    this.imgCoutryFlags.Images.SetKeyName(15, "au.png");
    this.imgCoutryFlags.Images.SetKeyName(16, "aw.png");
    this.imgCoutryFlags.Images.SetKeyName(17, "ax.png");
    this.imgCoutryFlags.Images.SetKeyName(18, "az.png");
    this.imgCoutryFlags.Images.SetKeyName(19, "ba.png");
    this.imgCoutryFlags.Images.SetKeyName(20, "bb.png");
    this.imgCoutryFlags.Images.SetKeyName(21, "bd.png");
    this.imgCoutryFlags.Images.SetKeyName(22, "be.png");
    this.imgCoutryFlags.Images.SetKeyName(23, "bf.png");
    this.imgCoutryFlags.Images.SetKeyName(24, "bg.png");
    this.imgCoutryFlags.Images.SetKeyName(25, "bh.png");
    this.imgCoutryFlags.Images.SetKeyName(26, "bi.png");
    this.imgCoutryFlags.Images.SetKeyName(27, "bj.png");
    this.imgCoutryFlags.Images.SetKeyName(28, "bm.png");
    this.imgCoutryFlags.Images.SetKeyName(29, "bn.png");
    this.imgCoutryFlags.Images.SetKeyName(30, "bo.png");
    this.imgCoutryFlags.Images.SetKeyName(31, "br.png");
    this.imgCoutryFlags.Images.SetKeyName(32, "bs.png");
    this.imgCoutryFlags.Images.SetKeyName(33, "bt.png");
    this.imgCoutryFlags.Images.SetKeyName(34, "bv.png");
    this.imgCoutryFlags.Images.SetKeyName(35, "bw.png");
    this.imgCoutryFlags.Images.SetKeyName(36, "by.png");
    this.imgCoutryFlags.Images.SetKeyName(37, "bz.png");
    this.imgCoutryFlags.Images.SetKeyName(38, "ca.png");
    this.imgCoutryFlags.Images.SetKeyName(39, "cc.png");
    this.imgCoutryFlags.Images.SetKeyName(40, "cd.png");
    this.imgCoutryFlags.Images.SetKeyName(41, "cf.png");
    this.imgCoutryFlags.Images.SetKeyName(42, "cg.png");
    this.imgCoutryFlags.Images.SetKeyName(43, "ch.png");
    this.imgCoutryFlags.Images.SetKeyName(44, "ci.png");
    this.imgCoutryFlags.Images.SetKeyName(45, "ck.png");
    this.imgCoutryFlags.Images.SetKeyName(46, "cl.png");
    this.imgCoutryFlags.Images.SetKeyName(47, "cm.png");
    this.imgCoutryFlags.Images.SetKeyName(48, "cn.png");
    this.imgCoutryFlags.Images.SetKeyName(49, "co.png");
    this.imgCoutryFlags.Images.SetKeyName(50, "cr.png");
    this.imgCoutryFlags.Images.SetKeyName(51, "cr.woa.png");
    this.imgCoutryFlags.Images.SetKeyName(52, "cs.png");
    this.imgCoutryFlags.Images.SetKeyName(53, "cu.png");
    this.imgCoutryFlags.Images.SetKeyName(54, "cv.png");
    this.imgCoutryFlags.Images.SetKeyName(55, "cx.png");
    this.imgCoutryFlags.Images.SetKeyName(56, "cy.png");
    this.imgCoutryFlags.Images.SetKeyName(57, "cz.png");
    this.imgCoutryFlags.Images.SetKeyName(58, "de.png");
    this.imgCoutryFlags.Images.SetKeyName(59, "dj.png");
    this.imgCoutryFlags.Images.SetKeyName(60, "dk.png");
    this.imgCoutryFlags.Images.SetKeyName(61, "dm.png");
    this.imgCoutryFlags.Images.SetKeyName(62, "do.png");
    this.imgCoutryFlags.Images.SetKeyName(63, "dz.png");
    this.imgCoutryFlags.Images.SetKeyName(64, "ec.png");
    this.imgCoutryFlags.Images.SetKeyName(65, "ee.png");
    this.imgCoutryFlags.Images.SetKeyName(66, "eg.png");
    this.imgCoutryFlags.Images.SetKeyName(67, "eh.png");
    this.imgCoutryFlags.Images.SetKeyName(68, "er.png");
    this.imgCoutryFlags.Images.SetKeyName(69, "es.png");
    this.imgCoutryFlags.Images.SetKeyName(70, "et.png");
    this.imgCoutryFlags.Images.SetKeyName(71, "fi.png");
    this.imgCoutryFlags.Images.SetKeyName(72, "fj.png");
    this.imgCoutryFlags.Images.SetKeyName(73, "fk.png");
    this.imgCoutryFlags.Images.SetKeyName(74, "fm.png");
    this.imgCoutryFlags.Images.SetKeyName(75, "fo.png");
    this.imgCoutryFlags.Images.SetKeyName(76, "fr.png");
    this.imgCoutryFlags.Images.SetKeyName(77, "fx.png");
    this.imgCoutryFlags.Images.SetKeyName(78, "ga.png");
    this.imgCoutryFlags.Images.SetKeyName(79, "gb.png");
    this.imgCoutryFlags.Images.SetKeyName(80, "gd.png");
    this.imgCoutryFlags.Images.SetKeyName(81, "ge.png");
    this.imgCoutryFlags.Images.SetKeyName(82, "gf.png");
    this.imgCoutryFlags.Images.SetKeyName(83, "gg.png");
    this.imgCoutryFlags.Images.SetKeyName(84, "gh.png");
    this.imgCoutryFlags.Images.SetKeyName(85, "gi.png");
    this.imgCoutryFlags.Images.SetKeyName(86, "gl.png");
    this.imgCoutryFlags.Images.SetKeyName(87, "gm.png");
    this.imgCoutryFlags.Images.SetKeyName(88, "gn.png");
    this.imgCoutryFlags.Images.SetKeyName(89, "gp.loc1.png");
    this.imgCoutryFlags.Images.SetKeyName(90, "gp.loc2.png");
    this.imgCoutryFlags.Images.SetKeyName(91, "gp.png");
    this.imgCoutryFlags.Images.SetKeyName(92, "gq.png");
    this.imgCoutryFlags.Images.SetKeyName(93, "gr.png");
    this.imgCoutryFlags.Images.SetKeyName(94, "gs.png");
    this.imgCoutryFlags.Images.SetKeyName(95, "gt.png");
    this.imgCoutryFlags.Images.SetKeyName(96, "gu.png");
    this.imgCoutryFlags.Images.SetKeyName(97, "gw.png");
    this.imgCoutryFlags.Images.SetKeyName(98, "gy.png");
    this.imgCoutryFlags.Images.SetKeyName(99, "hk.png");
    this.imgCoutryFlags.Images.SetKeyName(100, "hm.png");
    this.imgCoutryFlags.Images.SetKeyName(101, "hn.png");
    this.imgCoutryFlags.Images.SetKeyName(102, "hr.png");
    this.imgCoutryFlags.Images.SetKeyName(103, "ht.png");
    this.imgCoutryFlags.Images.SetKeyName(104, "ht.woa.png");
    this.imgCoutryFlags.Images.SetKeyName(105, "hu.png");
    this.imgCoutryFlags.Images.SetKeyName(106, "id.png");
    this.imgCoutryFlags.Images.SetKeyName(107, "ie.png");
    this.imgCoutryFlags.Images.SetKeyName(108, "il.png");
    this.imgCoutryFlags.Images.SetKeyName(109, "in.png");
    this.imgCoutryFlags.Images.SetKeyName(110, "io.png");
    this.imgCoutryFlags.Images.SetKeyName(111, "iq.png");
    this.imgCoutryFlags.Images.SetKeyName(112, "ir.png");
    this.imgCoutryFlags.Images.SetKeyName(113, "is.png");
    this.imgCoutryFlags.Images.SetKeyName(114, "it.png");
    this.imgCoutryFlags.Images.SetKeyName(115, "je.png");
    this.imgCoutryFlags.Images.SetKeyName(116, "jm.png");
    this.imgCoutryFlags.Images.SetKeyName(117, "jo.png");
    this.imgCoutryFlags.Images.SetKeyName(118, "jp.png");
    this.imgCoutryFlags.Images.SetKeyName(119, "ke.png");
    this.imgCoutryFlags.Images.SetKeyName(120, "kg.png");
    this.imgCoutryFlags.Images.SetKeyName(121, "kh.png");
    this.imgCoutryFlags.Images.SetKeyName(122, "ki.png");
    this.imgCoutryFlags.Images.SetKeyName(123, "km.png");
    this.imgCoutryFlags.Images.SetKeyName(124, "kn.png");
    this.imgCoutryFlags.Images.SetKeyName(125, "kp.png");
    this.imgCoutryFlags.Images.SetKeyName(126, "kr.png");
    this.imgCoutryFlags.Images.SetKeyName((int) sbyte.MaxValue, "kw.png");
    this.imgCoutryFlags.Images.SetKeyName(128, "ky.png");
    this.imgCoutryFlags.Images.SetKeyName(129, "kz.png");
    this.imgCoutryFlags.Images.SetKeyName(130, "la.png");
    this.imgCoutryFlags.Images.SetKeyName(131, "lb.png");
    this.imgCoutryFlags.Images.SetKeyName(132, "lc.png");
    this.imgCoutryFlags.Images.SetKeyName(133, "li.png");
    this.imgCoutryFlags.Images.SetKeyName(134, "li.woa.png");
    this.imgCoutryFlags.Images.SetKeyName(135, "lk.png");
    this.imgCoutryFlags.Images.SetKeyName(136, "lr.png");
    this.imgCoutryFlags.Images.SetKeyName(137, "ls.png");
    this.imgCoutryFlags.Images.SetKeyName(138, "lt.png");
    this.imgCoutryFlags.Images.SetKeyName(139, "lu.png");
    this.imgCoutryFlags.Images.SetKeyName(140, "lv.png");
    this.imgCoutryFlags.Images.SetKeyName(141, "ly.png");
    this.imgCoutryFlags.Images.SetKeyName(142, "ma.png");
    this.imgCoutryFlags.Images.SetKeyName(143, "mc.png");
    this.imgCoutryFlags.Images.SetKeyName(144, "md.png");
    this.imgCoutryFlags.Images.SetKeyName(145, "me.png");
    this.imgCoutryFlags.Images.SetKeyName(146, "mg.png");
    this.imgCoutryFlags.Images.SetKeyName(147, "mh.png");
    this.imgCoutryFlags.Images.SetKeyName(148, "mk.png");
    this.imgCoutryFlags.Images.SetKeyName(149, "ml.png");
    this.imgCoutryFlags.Images.SetKeyName(150, "mm.png");
    this.imgCoutryFlags.Images.SetKeyName(151, "mn.png");
    this.imgCoutryFlags.Images.SetKeyName(152, "mo.png");
    this.imgCoutryFlags.Images.SetKeyName(153, "mp.png");
    this.imgCoutryFlags.Images.SetKeyName(154, "mq.png");
    this.imgCoutryFlags.Images.SetKeyName(155, "mq.snake1.png");
    this.imgCoutryFlags.Images.SetKeyName(156, "mq.snake2.png");
    this.imgCoutryFlags.Images.SetKeyName(157, "mr.png");
    this.imgCoutryFlags.Images.SetKeyName(158, "ms.png");
    this.imgCoutryFlags.Images.SetKeyName(159, "mt.png");
    this.imgCoutryFlags.Images.SetKeyName(160, "mu.png");
    this.imgCoutryFlags.Images.SetKeyName(161, "mv.png");
    this.imgCoutryFlags.Images.SetKeyName(162, "mw.png");
    this.imgCoutryFlags.Images.SetKeyName(163, "mx.png");
    this.imgCoutryFlags.Images.SetKeyName(164, "my.png");
    this.imgCoutryFlags.Images.SetKeyName(165, "mz.png");
    this.imgCoutryFlags.Images.SetKeyName(166, "na.png");
    this.imgCoutryFlags.Images.SetKeyName(167, "nc.png");
    this.imgCoutryFlags.Images.SetKeyName(168, "ne.png");
    this.imgCoutryFlags.Images.SetKeyName(169, "nf.png");
    this.imgCoutryFlags.Images.SetKeyName(170, "ng.png");
    this.imgCoutryFlags.Images.SetKeyName(171, "ni.png");
    this.imgCoutryFlags.Images.SetKeyName(172, "ni.woa.png");
    this.imgCoutryFlags.Images.SetKeyName(173, "nl.png");
    this.imgCoutryFlags.Images.SetKeyName(174, "no.png");
    this.imgCoutryFlags.Images.SetKeyName(175, "np.png");
    this.imgCoutryFlags.Images.SetKeyName(176, "nr.png");
    this.imgCoutryFlags.Images.SetKeyName(177, "nu.png");
    this.imgCoutryFlags.Images.SetKeyName(178, "nz.png");
    this.imgCoutryFlags.Images.SetKeyName(179, "om.png");
    this.imgCoutryFlags.Images.SetKeyName(180, "pa.png");
    this.imgCoutryFlags.Images.SetKeyName(181, "pe.png");
    this.imgCoutryFlags.Images.SetKeyName(182, "pe.woa.png");
    this.imgCoutryFlags.Images.SetKeyName(183, "pf.png");
    this.imgCoutryFlags.Images.SetKeyName(184, "pg.png");
    this.imgCoutryFlags.Images.SetKeyName(185, "ph.png");
    this.imgCoutryFlags.Images.SetKeyName(186, "pk.png");
    this.imgCoutryFlags.Images.SetKeyName(187, "pl.png");
    this.imgCoutryFlags.Images.SetKeyName(188, "pm.png");
    this.imgCoutryFlags.Images.SetKeyName(189, "pn.png");
    this.imgCoutryFlags.Images.SetKeyName(190, "pr.png");
    this.imgCoutryFlags.Images.SetKeyName(191, "ps.png");
    this.imgCoutryFlags.Images.SetKeyName(192, "pt.png");
    this.imgCoutryFlags.Images.SetKeyName(193, "pw.png");
    this.imgCoutryFlags.Images.SetKeyName(194, "py.png");
    this.imgCoutryFlags.Images.SetKeyName(195, "qa.png");
    this.imgCoutryFlags.Images.SetKeyName(196, "re.png");
    this.imgCoutryFlags.Images.SetKeyName(197, "ro.png");
    this.imgCoutryFlags.Images.SetKeyName(198, "rs.png");
    this.imgCoutryFlags.Images.SetKeyName(199, "rs.woa.png");
    this.imgCoutryFlags.Images.SetKeyName(200, "ru.png");
    this.imgCoutryFlags.Images.SetKeyName(201, "rw.png");
    this.imgCoutryFlags.Images.SetKeyName(202, "sa.png");
    this.imgCoutryFlags.Images.SetKeyName(203, "sb.png");
    this.imgCoutryFlags.Images.SetKeyName(204, "sc.png");
    this.imgCoutryFlags.Images.SetKeyName(205, "sd.png");
    this.imgCoutryFlags.Images.SetKeyName(206, "se.png");
    this.imgCoutryFlags.Images.SetKeyName(207, "sg.png");
    this.imgCoutryFlags.Images.SetKeyName(208, "sh.png");
    this.imgCoutryFlags.Images.SetKeyName(209, "si.png");
    this.imgCoutryFlags.Images.SetKeyName(210, "sj.png");
    this.imgCoutryFlags.Images.SetKeyName(211, "sk.png");
    this.imgCoutryFlags.Images.SetKeyName(212, "sl.png");
    this.imgCoutryFlags.Images.SetKeyName(213, "sm.png");
    this.imgCoutryFlags.Images.SetKeyName(214, "sn.png");
    this.imgCoutryFlags.Images.SetKeyName(215, "so.png");
    this.imgCoutryFlags.Images.SetKeyName(216, "sr.png");
    this.imgCoutryFlags.Images.SetKeyName(217, "st.png");
    this.imgCoutryFlags.Images.SetKeyName(218, "sv.png");
    this.imgCoutryFlags.Images.SetKeyName(219, "sv.woa.png");
    this.imgCoutryFlags.Images.SetKeyName(220, "sy.png");
    this.imgCoutryFlags.Images.SetKeyName(221, "sz.png");
    this.imgCoutryFlags.Images.SetKeyName(222, "tc.png");
    this.imgCoutryFlags.Images.SetKeyName(223, "td.png");
    this.imgCoutryFlags.Images.SetKeyName(224, "tf.png");
    this.imgCoutryFlags.Images.SetKeyName(225, "tg.png");
    this.imgCoutryFlags.Images.SetKeyName(226, "th.png");
    this.imgCoutryFlags.Images.SetKeyName(227, "tj.png");
    this.imgCoutryFlags.Images.SetKeyName(228, "tk.png");
    this.imgCoutryFlags.Images.SetKeyName(229, "tl.png");
    this.imgCoutryFlags.Images.SetKeyName(230, "tm.png");
    this.imgCoutryFlags.Images.SetKeyName(231, "tn.png");
    this.imgCoutryFlags.Images.SetKeyName(232, "to.png");
    this.imgCoutryFlags.Images.SetKeyName(233, "tp.png");
    this.imgCoutryFlags.Images.SetKeyName(234, "tr.png");
    this.imgCoutryFlags.Images.SetKeyName(235, "tt.png");
    this.imgCoutryFlags.Images.SetKeyName(236, "tv.png");
    this.imgCoutryFlags.Images.SetKeyName(237, "tw.png");
    this.imgCoutryFlags.Images.SetKeyName(238, "tz.png");
    this.imgCoutryFlags.Images.SetKeyName(239, "ua.png");
    this.imgCoutryFlags.Images.SetKeyName(240, "ug.png");
    this.imgCoutryFlags.Images.SetKeyName(241, "um.png");
    this.imgCoutryFlags.Images.SetKeyName(242, "us.png");
    this.imgCoutryFlags.Images.SetKeyName(243, "uy.png");
    this.imgCoutryFlags.Images.SetKeyName(244, "uz.png");
    this.imgCoutryFlags.Images.SetKeyName(245, "va.png");
    this.imgCoutryFlags.Images.SetKeyName(246, "vc.png");
    this.imgCoutryFlags.Images.SetKeyName(247, "ve.png");
    this.imgCoutryFlags.Images.SetKeyName(248, "vg.png");
    this.imgCoutryFlags.Images.SetKeyName(249, "vi.png");
    this.imgCoutryFlags.Images.SetKeyName(250, "vn.png");
    this.imgCoutryFlags.Images.SetKeyName(251, "vu.png");
    this.imgCoutryFlags.Images.SetKeyName(252, "wf.png");
    this.imgCoutryFlags.Images.SetKeyName(253, "ws.png");
    this.imgCoutryFlags.Images.SetKeyName(254, "ye.png");
    this.imgCoutryFlags.Images.SetKeyName((int) byte.MaxValue, "yt.png");
    this.imgCoutryFlags.Images.SetKeyName(256, "yu.png");
    this.imgCoutryFlags.Images.SetKeyName(257, "za.png");
    this.imgCoutryFlags.Images.SetKeyName(258, "zm.png");
    this.imgCoutryFlags.Images.SetKeyName(259, "zw.png");
    this.imgCoutryFlags.Images.SetKeyName(260, "none.png");
    this.imgCoutryFlags.Images.SetKeyName(261, "--.png");
    this.ResumeLayout(false);
  }

  public event UrlListView.OnItemsChangedEventHandler OnItemsChanged;

  public string FilePath { get; set; }

  public bool AutoScroll { get; set; }

  public int IndexIP { get; set; }

  public int IndexCountry { get; set; }

  public int IndexDate { get; set; }

  public bool AutoLoadItems { get; set; }

  public List<ListViewItem> SelectedItems
  {
    get
    {
      List<ListViewItem> listViewItemList = new List<ListViewItem>();
      try
      {
        foreach (ListViewItem selectedItem in base.SelectedItems)
          listViewItemList.Add(selectedItem);
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
      return listViewItemList;
    }
  }

  public string[] GetAvailableMethod()
  {
    List<UrlListView.TAGEXT> o = new List<UrlListView.TAGEXT>();
    try
    {
      foreach (KeyValuePair<Types, List<DataRow>> keyValuePair in this.__VulDB.Method)
        o.Add(new UrlListView.TAGEXT()
        {
          Name = Utls.TypeToString(keyValuePair.Key) + " (" + Conversions.ToString(keyValuePair.Value.Count) + ")",
          Value = keyValuePair.Value.Count
        });
    }
    finally
    {
      Dictionary<Types, List<DataRow>>.Enumerator enumerator;
      enumerator.Dispose();
    }
    return this.SortListDesc(o).ToArray();
  }

  public string[] GetAvailableCountry()
  {
    List<UrlListView.TAGEXT> o = new List<UrlListView.TAGEXT>();
    try
    {
      foreach (KeyValuePair<string, List<DataRow>> keyValuePair in this.__VulDB.Country)
      {
        if (keyValuePair.Value.Count > 0)
          o.Add(new UrlListView.TAGEXT()
          {
            Name = keyValuePair.Key + " (" + Conversions.ToString(keyValuePair.Value.Count) + ")",
            Value = keyValuePair.Value.Count
          });
      }
    }
    finally
    {
      Dictionary<string, List<DataRow>>.Enumerator enumerator;
      enumerator.Dispose();
    }
    List<string> stringList = this.SortListDesc(o);
    stringList.Insert(0, "ALL (" + Conversions.ToString(this.__VulDB.Country.Count) + ")");
    return stringList.ToArray();
  }

  private List<string> SortListDesc(List<UrlListView.TAGEXT> o)
  {
    List<string> stringList = new List<string>();
    int num = 0;
    UrlListView.TAGEXT tagext1 = (UrlListView.TAGEXT) null;
    while (o.Count > 0)
    {
      try
      {
        foreach (UrlListView.TAGEXT tagext2 in o)
        {
          if (tagext2.Value > num)
          {
            num = tagext2.Value;
            tagext1 = tagext2;
          }
        }
      }
      finally
      {
        List<UrlListView.TAGEXT>.Enumerator enumerator;
        enumerator.Dispose();
      }
      stringList.Add(tagext1.Name);
      o.Remove(tagext1);
      num = 0;
    }
    return stringList;
  }

  internal void OnItemsChange()
  {
    UrlListView.OnItemsChangedEventHandler itemsChangedEvent = this.OnItemsChangedEvent;
    if (itemsChangedEvent == null)
      return;
    itemsChangedEvent((object) this);
  }

  private void ProcAutoScroll(int selectIndex)
  {
    try
    {
      this.Items[selectIndex].EnsureVisible();
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
  }

  public int SelectedRowsCount() => this.SelectedItems.Count;

  public int Count() => this.__VulDB != null ? this.__VulDB.All.Count : 0;

  public int VisibleCount() => this.Items.Count;

  public List<string> GetDomains() => this.__VulDB.Domains;

  public bool ContainsAsDomain(string sURL) => this.__VulDB.Domains.Contains(Globals.G_Utilities.GetDomain(sURL));

  public bool Contains(string sURL) => this.__VulDB.All.ContainsKey(sURL);

  public List<string> GetItemsAsURL() => this.__VulDB.UrlList();

  public IEnumerator GetEnumerator() => (IEnumerator) this.__VulDB.All.Keys.GetEnumerator();

  public List<string> ListItems()
  {
    List<string> stringList = new List<string>();
    stringList.AddRange((IEnumerable<string>) this.__VulDB.All.Keys);
    return stringList;
  }

  public void FocusItem(string url)
  {
    if (this.InvokeRequired)
    {
      this.Invoke((Delegate) new UrlListView.OBInvokeStr(this.FocusItem), (object) url);
    }
    else
    {
      try
      {
        foreach (ListViewItem listViewItem in this.Items)
        {
          listViewItem.Selected = false;
          if (listViewItem.Text.Equals(url))
          {
            listViewItem.Selected = true;
            this.ProcAutoScroll(listViewItem.Index);
          }
        }
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
    }
  }

  public void RemoveSeleted()
  {
    if (this.InvokeRequired)
    {
      this.Invoke((Delegate) new UrlListView.OBInvoke(this.RemoveSeleted));
    }
    else
    {
      while (this.SelectedItems.Count > 0)
        this.Remove(this.SelectedItems[0]);
    }
  }

  public void Remove(string url)
  {
    if (this.InvokeRequired)
    {
      this.Invoke((Delegate) new UrlListView.OBInvokeStr(this.Remove), (object) url);
    }
    else
    {
      this.__VulDB.Remove(url);
      this.OnItemsChange();
    }
  }

  public void Remove(ListViewItem o)
  {
    if (this.InvokeRequired)
    {
      this.Invoke((Delegate) new UrlListView.OBInvokeObj(this.Remove), (object) o);
    }
    else
    {
      this.__VulDB.Remove((DataRow) o.Tag);
      this.OnItemsChange();
    }
  }

  public bool Add(string[] v)
  {
    if (this.InvokeRequired)
      return Conversions.ToBoolean(this.Invoke((Delegate) (a0 => this.Add((string[]) a0)), (object[]) v));
    bool flag = this.__VulDB.Add(v);
    if (this.AutoScroll)
      this.ProcAutoScroll(checked (this.Items.Count - 1));
    this.OnItemsChange();
    return flag;
  }

  public bool Add(string v)
  {
    if (this.InvokeRequired)
      return Conversions.ToBoolean(this.Invoke((Delegate) new UrlListView.OBInvokeAddStr(this.Add), (object) v));
    bool flag = this.Add(new string[1]{ v });
    this.OnItemsChange();
    return flag;
  }

  public bool Add(ListViewItem o)
  {
    if (this.InvokeRequired)
      return Conversions.ToBoolean(this.Invoke((Delegate) new UrlListView.OBInvokeAddObj(this.Add), (object) o));
    string[] v = new string[checked (o.SubItems.Count + 1)];
    v[0] = o.Text;
    int num = checked (o.SubItems.Count - 1);
    int index = 0;
    while (index <= num)
    {
      v[checked (index + 1)] = o.SubItems[index].Text;
      checked { ++index; }
    }
    return this.Add(v);
  }

  public void Update(DataRow o, string v, int i)
  {
    if (this.InvokeRequired)
    {
      this.Invoke((Delegate) new UrlListView.OBInvokeUpdateObj(this.Update), (object) o, (object) v, (object) i);
    }
    else
    {
      UrlListView.VulDB vulDb = this.__VulDB;
      object[] objArray1 = new object[3];
      object[] objArray2 = objArray1;
      DataRow dataRow1 = o;
      DataRow dataRow2 = dataRow1;
      int columnIndex = 0;
      object objectValue = RuntimeHelpers.GetObjectValue(dataRow2[0]);
      objArray2[0] = objectValue;
      objArray1[1] = (object) v;
      objArray1[2] = (object) i;
      object[] objArray3 = objArray1;
      object[] Arguments = objArray3;
      bool[] flagArray = new bool[3]{ true, true, true };
      bool[] CopyBack = flagArray;
      NewLateBinding.LateCall((object) vulDb, (System.Type) null, "UpDate", Arguments, (string[]) null, (System.Type[]) null, CopyBack, true);
      if (flagArray[0])
        dataRow1[columnIndex] = RuntimeHelpers.GetObjectValue(objArray3[0]);
      if (flagArray[1])
        v = (string) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray3[1]), typeof (string));
      if (!flagArray[2])
        return;
      i = (int) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray3[2]), typeof (int));
    }
  }

  public void Update(string url, string v, int i)
  {
    if (this.InvokeRequired)
      this.Invoke((Delegate) new UrlListView.OBInvokeUpdateStr(this.Update), (object) url, (object) v, (object) i);
    else
      this.__VulDB.UpDate(url, v, i);
  }

  public UrlListView()
  {
    this.IndexIP = -1;
    this.IndexCountry = -1;
    this.IndexDate = -1;
    this.AutoLoadItems = true;
    this.__VulDB = new UrlListView.VulDB(this);
    this.InitializeComponent();
    this.MultiSelect = true;
    this.ShowItemToolTips = true;
  }

  public void Init(string sPath)
  {
    this.FilePath = sPath;
    if (this.IndexIP > 0)
      this.SmallImageList = this.imgCoutryFlags;
    else
      this.SmallImageList = (ImageList) null;
    this.__VulDB = new UrlListView.VulDB(this);
    this.OnItemsChange();
  }

  public int FilterVulns(Types oSQL = Types.None, string sCountry = "", string sMatch = "", int iMatch = 0)
  {
    if (this.InvokeRequired)
      return Conversions.ToInteger(this.Invoke((Delegate) ((a0, a1, a2) => this.FilterVulns(a0, a1, a2)), (object) oSQL, (object) sCountry, (object) sMatch));
    int count = this.Items.Count;
    this.BeginUpdate();
    this.Items.Clear();
    this.Items.AddRange(this.__VulDB.ListViewItems(oSQL, sCountry, sMatch, iMatch).ToArray());
    this.EndUpdate();
    this.OnItemsChange();
    return checked (count - this.Items.Count);
  }

  public void SaveFile() => this.__VulDB.SaveXML();

  public delegate void OnItemsChangedEventHandler(object sender);

  private class TAGEXT
  {
    public string Name { get; set; }

    public int Value { get; set; }
  }

  internal class VulDB
  {
    private UrlListView Base;
    private bool IsReadingFile;
    [AccessedThroughProperty("LockWindowAPI")]
    private System.Timers.Timer _LockWindowAPI;
    [SpecialName]
    private int .STATIC.ProcLoading.202188.LastLoad;
    [SpecialName]
    private DataTable .STATIC.GetDataRow.201128271E.t;
    [SpecialName]
    private int .STATIC.LockWindowAPI_Elapsed.20211C12827D.Tick;

    public Dictionary<Types, List<DataRow>> Method { get; set; }

    public Dictionary<string, List<DataRow>> Country { get; set; }

    public Dictionary<string, DataRow> All { get; set; }

    public List<string> Domains { get; set; }

    public VulDB(UrlListView o)
    {
      this.Method = new Dictionary<Types, List<DataRow>>();
      this.Country = new Dictionary<string, List<DataRow>>();
      this.All = new Dictionary<string, DataRow>();
      this.Domains = new List<string>();
      this.LockWindowAPI = new System.Timers.Timer();
      this.LockWindowAPI.Interval = 500.0;
      this.Base = o;
      this.ReadXML();
    }

    public bool Add(string[] v)
    {
      string sUrlEntered = v[0];
      if (!sUrlEntered.ToLower().StartsWith("http"))
        return false;
      string domain = Globals.G_Utilities.GetDomain(sUrlEntered);
      if (string.IsNullOrEmpty(domain) || this.Domains.Contains(domain))
        return false;
      DataRow r = this.GetTable().NewRow();
      int num = checked (v.Length - 1);
      int columnIndex = 0;
      while (columnIndex <= num)
      {
        r[columnIndex] = (object) v[columnIndex];
        checked { ++columnIndex; }
      }
      this.Add(r);
      return true;
    }

    public bool Add(DataRow r)
    {
      string str = r[0].ToString();
      bool flag;
      if (str.ToLower().StartsWith("http") && !this.All.ContainsKey(str))
      {
        string domain = Globals.G_Utilities.GetDomain(str);
        if (string.IsNullOrEmpty(domain) || this.Domains.Contains(domain))
          return false;
        this.Domains.Add(domain);
        new ParameterizedThreadStart(this.ListViewAdd)((object) this.ListViewConvertRow(r));
        this.All.Add(str, r);
        Types type = Utls.StringToType(r[1].ToString());
        if (!this.Method.ContainsKey(type))
          this.Method.Add(type, new List<DataRow>());
        this.Method[type].Add(r);
        if (this.Base.IndexCountry > 0)
        {
          string key = Conversions.ToString(r[this.Base.IndexCountry]);
          if (!this.Country.ContainsKey(key))
            this.Country.Add(key, new List<DataRow>());
          this.Country[key].Add(r);
        }
        flag = true;
      }
      return flag;
    }

    public void Remove(DataRow r) => this.Remove(r[0].ToString());

    public void Remove(string sUrl)
    {
      if (!this.All.ContainsKey(sUrl))
        return;
      DataRow r = this.All[sUrl];
      this.ListViewRem(this.GetListViewItem(r));
      try
      {
        foreach (object obj in Enum.GetValues(typeof (Types)))
        {
          Types integer = (Types) Conversions.ToInteger(obj);
          if (this.Method.ContainsKey(integer) && this.Method[integer].Contains(r))
          {
            this.Method[integer].Remove(r);
            if (this.Method[integer].Count == 0)
            {
              this.Method.Remove(integer);
              break;
            }
            break;
          }
        }
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
      if (this.Base.IndexCountry > 0)
      {
        string key = Conversions.ToString(r[this.Base.IndexCountry]);
        if (this.Country.ContainsKey(key))
        {
          this.Country[key].Remove(r);
          if (this.Country[key].Count == 0)
            this.Country.Remove(key);
        }
      }
      this.All.Remove(sUrl);
      string domain = Globals.G_Utilities.GetDomain(sUrl);
      if (!this.Domains.Contains(domain))
        return;
      this.Domains.Remove(domain);
    }

    public void UpDate(string url, string sValue, int index) => this.UpDate(this.All[url], sValue, index);

    public void UpDate(DataRow r, string sValue, int index)
    {
      if (!this.All.ContainsValue(r))
        return;
      r[index] = (object) sValue;
      this.ListViewUpdate(r);
    }

    private void ListViewAdd(object o)
    {
      if (this.IsReadingFile)
        return;
      if (this.Base.InvokeRequired)
        this.Base.Invoke((Delegate) new UrlListView.VulDB.DLGListView(this.ListViewAdd), RuntimeHelpers.GetObjectValue(o));
      else if (o is ListViewItem)
        this.Base.Items.Add((ListViewItem) o);
      else
        this.Base.Groups.Add((ListViewGroup) o);
    }

    private void ListViewRem(ListViewItem o)
    {
      if (this.Base.InvokeRequired)
      {
        this.Base.Invoke((Delegate) (a0 => this.ListViewRem((ListViewItem) a0)), (object) o);
      }
      else
      {
        Globals.LockWindowUpdate(this.Base.Handle);
        this.Base.Items.Remove(o);
        Globals.LockWindowUpdate(IntPtr.Zero);
      }
    }

    private void ListViewUpdate(DataRow r)
    {
      if (this.Base.InvokeRequired)
      {
        this.Base.Invoke((Delegate) (a0 => this.ListViewUpdate((DataRow) a0)), (object) r);
      }
      else
      {
        Globals.LockWindowUpdate(this.Base.Handle);
        ListViewItem listViewItem = this.GetListViewItem(r);
        listViewItem.Text = Conversions.ToString(r[0]);
        if (r.ItemArray.Length > 11)
          listViewItem.ToolTipText = Conversions.ToString(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(r[0], (object) "\r\n"), r[this.Base.IndexCountry]), (object) "\r\n"), (object) r[10].ToString().Replace("; ", "\r\n")), (object) r[11].ToString().Replace("; ", "\r\n")), (object) r[12].ToString().Replace("; ", "\r\n")));
        int num1 = checked (r.ItemArray.Length - 2);
        int num2 = 1;
        while (num2 <= num1)
        {
          listViewItem.SubItems[num2].Text = r[num2].ToString();
          checked { ++num2; }
        }
        Globals.LockWindowUpdate(IntPtr.Zero);
      }
    }

    public List<string> UrlList()
    {
      List<string> stringList = new List<string>();
      if (this.All.Keys.Count > 0)
      {
        string[] array = new string[checked (this.All.Keys.Count - 1 + 1)];
        this.All.Keys.CopyTo(array, 0);
        stringList.AddRange((IEnumerable<string>) array);
      }
      return stringList;
    }

    public List<ListViewItem> ListViewItems(
      Types t,
      string sContry,
      string sSearch,
      int iMatch)
    {
      List<DataRow> dataRowList = new List<DataRow>();
      List<ListViewItem> listViewItemList = new List<ListViewItem>();
      if (!string.IsNullOrEmpty(sContry))
      {
        if (this.Country.ContainsKey(sContry))
        {
          try
          {
            foreach (DataRow dataRow in this.Country[sContry])
            {
              Types integer = (Types) Conversions.ToInteger(Interaction.IIf(t != Types.None, (object) Utls.StringToType(dataRow[1].ToString()), (object) t));
              if (t == Types.None || integer.Equals((object) t))
                dataRowList.Add(dataRow);
            }
            goto label_12;
          }
          finally
          {
            List<DataRow>.Enumerator enumerator;
            enumerator.Dispose();
          }
        }
      }
      if (!string.IsNullOrEmpty(sContry))
        return listViewItemList;
      if (t == Types.None)
        dataRowList.AddRange((IEnumerable<DataRow>) this.All.Values);
      else if (this.Method.ContainsKey(t))
        dataRowList.AddRange((IEnumerable<DataRow>) this.Method[t].ToArray());
label_12:
      if (string.IsNullOrEmpty(sSearch))
      {
        ListViewItem[] listViewItemArray = Array.ConvertAll<DataRow, ListViewItem>(dataRowList.ToArray(), new Converter<DataRow, ListViewItem>(this.GetListViewItem));
        listViewItemList.AddRange((IEnumerable<ListViewItem>) listViewItemArray);
      }
      else
      {
        try
        {
          foreach (DataRow o in dataRowList)
          {
            bool flag;
            switch (iMatch)
            {
              case 0:
                flag = o[0].ToString().ToLower().Contains(sSearch.ToLower());
                break;
              case 1:
                flag = o[2].ToString().ToLower().Contains(sSearch.ToLower());
                break;
              case 2:
                flag = o[3].ToString().ToLower().Contains(sSearch.ToLower());
                break;
              case 3:
                flag = o[4].ToString().ToLower().Contains(sSearch.ToLower());
                break;
              case 4:
                flag = o[5].ToString().ToLower().Contains(sSearch.ToLower());
                break;
              case 5:
                flag = o[8].ToString().ToLower().Contains(sSearch.ToLower());
                break;
              case 6:
                flag = o[9].ToString().ToLower().Contains(sSearch.ToLower());
                break;
              case 7:
                flag = o[10].ToString().ToLower().Contains(sSearch.ToLower()) | o[11].ToString().ToLower().Contains(sSearch.ToLower()) | o[12].ToString().ToLower().Contains(sSearch.ToLower()) | o[13].ToString().ToLower().Contains(sSearch.ToLower());
                break;
            }
            if (flag)
              listViewItemList.Add(this.ListViewConvertRow(o));
          }
        }
        finally
        {
          List<DataRow>.Enumerator enumerator;
          enumerator.Dispose();
        }
      }
      return listViewItemList;
    }

    private ListViewItem ListViewConvertRow(DataRow o)
    {
      object[] itemArray = o.ItemArray;
      ListViewItem listViewItem = new ListViewItem(itemArray[0].ToString());
      int num = checked (((IEnumerable<object>) itemArray).Count<object>() - 2);
      int index = 1;
      while (index <= num)
      {
        listViewItem.SubItems.Add(itemArray[index].ToString());
        checked { ++index; }
      }
      if (this.Base.IndexCountry > 0)
      {
        listViewItem.ImageKey = this.GetFlagKey(o[0].ToString(), o[this.Base.IndexIP].ToString());
        if (o.ItemArray.Length > 11)
          listViewItem.ToolTipText = Conversions.ToString(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(o[0], (object) "\r\n"), o[this.Base.IndexCountry]), (object) "\r\n"), (object) o[10].ToString().Replace("; ", "\r\n")), (object) o[11].ToString().Replace("; ", "\r\n")), (object) o[12].ToString().Replace("; ", "\r\n")));
        o[this.Base.IndexCountry] = (object) this.GetCountry(o[0].ToString(), o[this.Base.IndexIP].ToString());
      }
      o["ListViewItem"] = (object) listViewItem;
      listViewItem.Tag = (object) o;
      return listViewItem;
    }

    private string GetFlagKey(string sURL, string sIP)
    {
      string domainCode = Globals.G_Utilities.GetDomainCode(sURL);
      return !Globals.G_GEOIP.CountryCodeExist(domainCode) ? (!Globals.G_Utilities.IsIP(sIP) ? "--.png" : Globals.G_GEOIP.LookupCountryCode(sIP) + ".png") : domainCode + ".png";
    }

    private string GetCountry(string sURL, string sIP)
    {
      string sCode1 = Globals.G_Utilities.GetDomainCode(sURL);
      if (Globals.G_GEOIP.CountryCodeExist(sCode1))
        sCode1 = "[" + sCode1.ToUpper() + "] " + Globals.G_GEOIP.CountryNameByCode(sCode1);
      else if (this.Base.IndexIP > 0)
      {
        if (Globals.G_Utilities.IsIP(sIP))
        {
          string sCode2 = Globals.G_GEOIP.LookupCountryCode(sIP);
          sCode1 = "[" + sCode2.ToUpper() + "] " + Globals.G_GEOIP.CountryNameByCode(sCode2);
        }
        else
          sCode1 = "[--] N/A";
      }
      return sCode1;
    }

    private void ReadXML()
    {
      if (this.Base.InvokeRequired)
      {
        this.Base.Invoke((Delegate) ((sender, e) => this.ReadXML()));
      }
      else
      {
        this.IsReadingFile = true;
        UrlListView urlListView = this.Base;
        if (File.Exists(this.Base.FilePath))
        {
          if (this.Base.FilePath.ToLower().EndsWith(".xml".ToLower()))
          {
            DataTable table;
            try
            {
              table = this.GetTable(false);
              urlListView.BeginUpdate();
              int num = (int) table.ReadXml(urlListView.FilePath);
              table.Columns.Add(new DataColumn()
              {
                DataType = typeof (ListViewItem),
                ColumnName = "ListViewItem",
                DefaultValue = (object) new ListViewItem()
              });
            }
            catch (Exception ex)
            {
              ProjectData.SetProjectError(ex);
              table = this.GetTable();
              ProjectData.ClearProjectError();
            }
            int count = table.Rows.Count;
            int num1 = checked (table.Rows.Count - 1);
            int index = 0;
            while (index <= num1)
            {
              this.Add(table.Rows[index]);
              checked { ++index; }
            }
            table.AcceptChanges();
            table.Dispose();
          }
          else if (this.Base.FilePath.ToLower().EndsWith(".txt".ToLower()))
          {
            DataRow[] dataRowArray = Array.ConvertAll<string, DataRow>(((IEnumerable<string>) File.ReadAllLines(this.Base.FilePath)).Where<string>((Func<string, bool>) (line => line.ToLower().StartsWith("http"))).ToArray<string>(), new Converter<string, DataRow>(this.GetDataRow));
            int num = checked (dataRowArray.Length - 1);
            int index = 0;
            while (index <= num)
            {
              this.Add(dataRowArray[index]);
              checked { ++index; }
            }
          }
          if (this.Base.AutoLoadItems && this.All.Count > 0)
          {
            DataRow[] array = new DataRow[checked (this.All.Count - 1 + 1)];
            this.All.Values.CopyTo(array, 0);
            ListViewItem[] items = Array.ConvertAll<DataRow, ListViewItem>(array, new Converter<DataRow, ListViewItem>(this.GetListViewItem));
            urlListView.Items.AddRange(items);
          }
          urlListView.EndUpdate();
          urlListView.OnItemsChange();
        }
        this.IsReadingFile = false;
      }
    }

    private void ProcLoading(int value, int iUB)
    {
      if (Globals.G_Splash == null)
        return;
      int num = checked ((int) Math.Round(Math.Round(unchecked ((double) checked (value + 1 * 100) / (double) iUB), 0)));
      if (num == this..STATIC.ProcLoading.202188.LastLoad)
        return;
      Globals.G_Splash.UpDateLoadingExtra(0, Math.Round((double) checked (value + 1 * 100) / (double) iUB, 0).ToString() + " %");
      this..STATIC.ProcLoading.202188.LastLoad = num;
    }

    private ListViewItem GetListViewItem(DataRow r) => (ListViewItem) r["ListViewItem"];

    private DataRow GetDataRow(string arg)
    {
      if (this..STATIC.GetDataRow.201128271E.t == null)
        this..STATIC.GetDataRow.201128271E.t = this.GetTable();
      DataRow dataRow = this..STATIC.GetDataRow.201128271E.t.NewRow();
      dataRow[0] = (object) arg;
      return dataRow;
    }

    public void SaveXML()
    {
      if (File.Exists(this.Base.FilePath))
        File.Delete(this.Base.FilePath);
      if (this.All.Count == 0)
        return;
      if (this.Base.FilePath.ToLower().EndsWith(".xml".ToLower()))
      {
        DataTable table = this.GetTable();
        try
        {
          foreach (DataRow dataRow in this.All.Values)
            table.Rows.Add(dataRow.ItemArray);
        }
        finally
        {
          Dictionary<string, DataRow>.ValueCollection.Enumerator enumerator;
          enumerator.Dispose();
        }
        table.Columns.Remove("ListViewItem");
        table.WriteXml(this.Base.FilePath);
        table.Dispose();
      }
      else
      {
        if (!this.Base.FilePath.ToLower().EndsWith(".txt".ToLower()))
          return;
        string[] strArray = new string[checked (this.All.Count - 1 + 1)];
        this.All.Keys.CopyTo(strArray, 0);
        File.WriteAllLines(this.Base.FilePath, strArray);
      }
    }

    private DataTable GetTable(bool bAddLvw = true)
    {
      DataTable dataTable = new DataTable("Item");
      dataTable.BeginLoadData();
      int num1 = checked (this.Base.Columns.Count - 1);
      int num2 = 0;
      while (num2 <= num1)
      {
        dataTable.Columns.Add(new DataColumn()
        {
          DataType = typeof (string),
          ColumnName = "C" + checked (num2 + 1).ToString().PadLeft(2, '0')
        });
        checked { ++num2; }
      }
      if (bAddLvw)
        dataTable.Columns.Add(new DataColumn()
        {
          DataType = typeof (ListViewItem),
          ColumnName = "ListViewItem",
          DefaultValue = (object) new ListViewItem()
        });
      dataTable.EndLoadData();
      return dataTable;
    }

    private virtual System.Timers.Timer LockWindowAPI
    {
      get => this._LockWindowAPI;
      [MethodImpl(MethodImplOptions.Synchronized)] set
      {
        ElapsedEventHandler elapsedEventHandler = new ElapsedEventHandler(this.LockWindowAPI_Elapsed);
        if (this._LockWindowAPI != null)
          this._LockWindowAPI.Elapsed -= elapsedEventHandler;
        this._LockWindowAPI = value;
        if (this._LockWindowAPI == null)
          return;
        this._LockWindowAPI.Elapsed += elapsedEventHandler;
      }
    }

    private void LockWindowAPI_Elapsed(object sender, ElapsedEventArgs e)
    {
      if (this..STATIC.LockWindowAPI_Elapsed.20211C12827D.Tick > 0)
      {
        Globals.LockWindowUpdate(IntPtr.Zero);
        this.LockWindowAPI.Stop();
        this..STATIC.LockWindowAPI_Elapsed.20211C12827D.Tick = 0;
      }
      else
      {
        this.LockWindow();
        this..STATIC.LockWindowAPI_Elapsed.20211C12827D.Tick = 1;
      }
    }

    private void InitLockWindow()
    {
      if (this.LockWindowAPI.Enabled)
        return;
      this.LockWindowAPI.Start();
    }

    private void LockWindow()
    {
      if (this.Base.InvokeRequired)
        this.Base.Invoke((Delegate) ((sender, e) => this.LockWindow()));
      else
        Globals.LockWindowUpdate(this.Base.Handle);
    }

    private delegate void DLGListView(object o);
  }

  private delegate void OBInvoke();

  private delegate void OBInvokeStr(string v);

  private delegate void OBInvokeObj(ListViewItem o);

  private delegate bool OBInvokeAddStrs(object[] v);

  private delegate bool OBInvokeAddStr(string v);

  private delegate bool OBInvokeAddObj(ListViewItem o);

  private delegate void OBInvokeUpdateStr(string url, string v, int i);

  private delegate void OBInvokeUpdateObj(DataRow o, string v, int i);

  private delegate int DFilterVulns(Types oSQL, string sCountry, string sMatchURL);
}
